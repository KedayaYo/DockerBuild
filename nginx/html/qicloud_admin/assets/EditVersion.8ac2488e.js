import{_ as L}from"./index.9fa6ecce.js";/* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css                */import{f as _,c as x,aV as F,aS as B,aG as k,C as r,D as i,aJ as o,aI as n,aN as I,aO as T,aL as C,aK as w,aE as E,G as P,aF as N,b5 as O,b6 as S,bW as U,c0 as Y,bN as G,bO as M,aZ as j,bb as H,be as R}from"./arco.35cd4a57.js";import{g as J}from"./vue.1515c820.js";import{t as K}from"./terrace.management.1f90c17c.js";import{a as A}from"./version.656b297a.js";import{f as W,V as Z}from"./index.571baf06.js";import"./chart.c690dcf1.js";const q={props:{id:{type:String}},setup(u){let a;(e=>{e[e.green=1]="green",e[e.red=2]="red",e[e[""]=3]=""})(a||(a={}));const h=J(),t=_({versionCode:"",publishTime:"",funcDesc:"",status:2,PLATIDs:[]}),c=_([]),d=_(""),m=_(W(Z)),l=x(()=>t.value.funcDesc?t.value.funcDesc.split("br"):[]),f=x(()=>Boolean(u.id)),v=async()=>{const e=await K.getAll();c.value=e.data},b=async()=>{const e=await A.fetchOne(u.id);console.log(e.data.versionID),e.code===0&&(t.value={...e.data,PLATIDs:e.data.PLATList.map(({id:s})=>s)})},D=e=>{e.includes(-999)&&(t.value.PLATIDs=[-999,...c.value.map(s=>s.APPID)])},V=async()=>{t.value.publishTime=F().format("YYYY-MM-DD HH:mm:ss");const e=await A[f.value?"update":"insert"](t.value);e.code!==0?B.error(e.reason):(B.success(e.reason),h.go(-1))},p=async()=>{await v(),u.id&&await b()},y=e=>{const s=t.value.funcDesc.split("br");s.splice(e,1),t.value.funcDesc=s.join("br")},g=()=>{t.value.funcDesc+=`${d.value}br`,d.value=""};return(async()=>await p())(),{version:t,terraceOptions:c,contents:l,textContent:d,versionStatus:m,VersionStatusColor:a,handleDelete:y,handleContentPlus:g,handleChecked:D,submit:V}}};const z={class:"version-wrapper container"},Q={class:"version-message-box"},X={class:"version-message"},$={key:0};function ee(u,a,h,t,c,d){const m=O,l=S,f=U,v=Y,b=G,D=M,V=k("icon-plus"),p=j,y=H,g=R;return r(),i("div",z,[o(g,{style:{width:"100%"}},{default:n(()=>[o(y,{model:t.version,"label-col-props":{span:2,offset:0},onSubmit:t.submit},{default:n(()=>[o(l,{label:"\u7248\u672C\u53F7"},{default:n(()=>[o(m,{modelValue:t.version.versionCode,"onUpdate:modelValue":a[0]||(a[0]=e=>t.version.versionCode=e)},null,8,["modelValue"])]),_:1}),o(l,{label:"\u72B6\u6001"},{default:n(()=>[o(v,{modelValue:t.version.status,"onUpdate:modelValue":a[1]||(a[1]=e=>t.version.status=e),options:t.versionStatus},{label:n(({data:e})=>[o(f,{color:t.VersionStatusColor[e.value]},{default:n(()=>[I(T(e.title),1)]),_:2},1032,["color"])]),_:1},8,["modelValue","options"])]),_:1}),o(l,{label:"\u6240\u5C5E\u5E73\u53F0"},{default:n(()=>[o(D,{modelValue:t.version.PLATIDs,"onUpdate:modelValue":a[2]||(a[2]=e=>t.version.PLATIDs=e),placeholder:"\u8BF7\u9009\u62E9\u5E73\u53F0",multiple:""},{default:n(()=>[(r(!0),i(C,null,w(t.terraceOptions,e=>(r(),E(b,{key:e.PLATName,value:e.APPID,label:e.PLATName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(l,{label:"\u66F4\u65B0\u5185\u5BB9"},{default:n(()=>[P("div",Q,[P("ol",X,[(r(!0),i(C,null,w(t.contents,(e,s)=>(r(),i(C,{key:s},[e?(r(),i("li",$,[P("p",null,T(`${s+1}. ${e}`),1)])):N("",!0)],64))),128))]),o(m,{modelValue:t.textContent,"onUpdate:modelValue":a[3]||(a[3]=e=>t.textContent=e)},null,8,["modelValue"]),o(p,{style:{width:"120px"},disabled:!t.textContent,onClick:t.handleContentPlus},{default:n(()=>[o(V)]),_:1},8,["disabled","onClick"])])]),_:1}),o(l,null,{default:n(()=>[o(p,{style:{width:"100px"},"html-type":"submit"},{default:n(()=>[I("\u4FDD\u5B58")]),_:1})]),_:1})]),_:1},8,["model","onSubmit"])]),_:1})])}const be=L(q,[["render",ee],["__scopeId","data-v-b5612dc7"]]);export{be as default};
