import{_ as re}from"./index.9fa6ecce.js";/* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css                *//* empty css                *//* empty css                *//* empty css               *//* empty css               *//* empty css               */import{d as L,f as c,t as ce,C as p,aE as I,aI as e,aJ as t,D,aL as U,aK as $,aN as _,b5 as G,b6 as pe,bN as P,bO as R,aZ as W,bb as de,aG as S,u as B,aO as J,G as me,aF as _e,aS as h,b9 as ve,aY as fe,ba as ye,bG as ge,be as Ce,b2 as be}from"./arco.35cd4a57.js";import{g as he}from"./vue.1515c820.js";import{s as A}from"./site.20be6969.js";import{l as Ie}from"./logger.5138959a.js";import{f as M,F as ke,D as Fe,N as Se,S as De,C as Ve}from"./index.571baf06.js";/* empty css              *//* empty css               */import"./chart.c690dcf1.js";const we=[{title:"\u540D\u79F0",dataIndex:"siteName"},{title:"\u7F16\u53F7",dataIndex:"siteID",slotName:"siteID"},{title:"\u5730\u5740",dataIndex:"siteAddress"},{title:"\u76D1\u542C\u7C7B\u578B",dataIndex:"monitorType",align:"center",slotName:"MonitorType"},{title:"\u7AD9\u70B9\u6A21\u5F0F",dataIndex:"siteMode",align:"center",slotName:"siteMode"},{title:"\u64CD\u4F5C",dataIndex:"optional",align:"center",slotName:"optional",width:280}],Be=()=>({columns:we}),Me=Be,Ne=L({__name:"Filter",props:{networkModeOptions:{type:Array},computerModeOptions:{type:Array}},emits:["handleSubmit"],setup(n,{emit:N}){const l=n,C=N,v=c({siteName:"",networkMode:"",isComputer:"",isSiteType:-1}),T=({values:k})=>{C("handleSubmit",k)};return ce(l),(k,d)=>{const x=G,b=pe,m=P,y=R,z=W,O=de;return p(),I(O,{model:v.value,layout:"inline",class:"pb-4",onSubmit:T},{default:e(()=>[t(b,{label:"\u7AD9\u70B9\u540D\u79F0"},{default:e(()=>[t(x,{modelValue:v.value.siteName,"onUpdate:modelValue":d[0]||(d[0]=u=>v.value.siteName=u)},null,8,["modelValue"])]),_:1}),t(b,{label:"\u7F51\u7EDC\u6A21\u5F0F"},{default:e(()=>[t(y,{modelValue:v.value.networkMode,"onUpdate:modelValue":d[1]||(d[1]=u=>v.value.networkMode=u),class:"w-[180px]","allow-clear":""},{default:e(()=>[(p(!0),D(U,null,$(n.networkModeOptions,u=>(p(),I(m,{key:u.title,value:u.value,label:u.title},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(b,{label:"\u673A\u8F7D\u8BA1\u7B97\u673A"},{default:e(()=>[t(y,{modelValue:v.value.isComputer,"onUpdate:modelValue":d[2]||(d[2]=u=>v.value.isComputer=u),class:"w-[180px]","allow-clear":""},{default:e(()=>[(p(!0),D(U,null,$(n.computerModeOptions,u=>(p(),I(m,{key:u.title,value:u.value,label:u.title},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(b,null,{default:e(()=>[t(z,{type:"primary","html-type":"handleSubmit"},{default:e(()=>[_(" \u67E5\u8BE2 ")]),_:1})]),_:1})]),_:1},8,["model"])}}}),Te={class:"container"},xe={key:0},ze={class:"select-group"};var q=(n=>(n[n.UAVInfo=1]="UAVInfo",n[n.hiveinfo=2]="hiveinfo",n))(q||{}),H=(n=>(n[n.UAVID=1]="UAVID",n[n.hiveID=2]="hiveID",n))(H||{});const Oe=L({__name:"index",setup(n){const{columns:N}=Me(),l=c({showTotal:!0,total:0,pageSize:20,current:1}),C=he(),v=c({siteID:"",deviceType:"",deviceID:"",type:1101}),T=c([...M(Fe,["0","\u76F8\u673A"]),{title:"\u8FB9\u7F18\u8BA1\u7B97\u673A",value:3}]);c([]);const k=c([]),d=c(!1),x=c(M(Se));c(M(De));const b=c(M(Ve)),m=c({uploadCurrentInfo:{}}),y=async(a={page:1,size:30})=>{const i=await A.get(a);i.code===0&&(l.value.total=i.data.total,k.value=i.data.list.map(s=>({...s,monitorType:(s==null?void 0:s.monitorType)==="osdk",uploadCurrentInfo:JSON.parse(JSON.stringify(v.value))})))},z=a=>{y({page:l.value.current,size:l.value.pageSize,...a})},O=a=>{a?C.push(`edit-site:${a}`):C.push("create-site")},u=()=>O(),K=async a=>{(await A.delete(a)).code===0&&(h.success("\u8BF7\u6C42\u6210\u529F"),y({page:l.value.current,size:l.value.pageSize}))},Y=async(a,i)=>{const F=(f=>{const V=JSON.parse(JSON.stringify(f));return V.monitorType=f.monitorType?"osdk":"msdk",V})(i),g=await A.changeMonitor({...F});g.code===0?h.success("\u8BF7\u6C42\u6210\u529F"):h.error(g.reason),y({page:l.value.current,size:l.value.pageSize})},E=async a=>{const{siteID:i,uploadCurrentInfo:s}=m.value;return s.siteID=i,new Promise((F,g)=>{try{s.deviceType!==3&&(s.deviceID=a[q[s.deviceType]][H[s.deviceType]]),Ie.syncDeviceLogger(s).then(f=>{f.code===0?(h.success("\u8BF7\u6C42\u6210\u529F"),F(!0)):(h.error(f.reason),g(!1))})}catch{h.warning("\u65E0\u8BBE\u5907\u7F16\u53F7"),g(!1)}})},Z=async a=>{m.value=JSON.parse(JSON.stringify(a)),m.value.uploadCurrentInfo.deviceType===3?d.value=!0:E(a)},j=()=>(E(m),!0),Q=()=>{m.value={uploadCurrentInfo:{}}},X=a=>{l.value.current=a,y({page:l.value.current,size:l.value.pageSize})};return y({page:l.value.current,size:l.value.pageSize}),(a,i)=>{const s=ve,F=S("router-link"),g=fe,f=ye,V=P,ee=R,te=S("icon-upload"),w=W,oe=S("icon-edit"),ae=S("icon-public"),ne=S("icon-delete"),le=ge,ue=Ce,se=G,ie=be;return p(),D("div",Te,[t(ue,{style:{width:"100%"},title:"\u7AD9\u70B9\u7BA1\u7406"},{extra:e(()=>[t(s,{onClick:u},{default:e(()=>[_("\u65B0\u589E")]),_:1})]),default:e(()=>[t(Ne,{"network-mode-options":x.value,"computer-mode-options":b.value,onHandleSubmit:z},null,8,["network-mode-options","computer-mode-options"]),t(le,{"show-jumper":"","show-total":!0,data:k.value,columns:B(N),pagination:l.value,onPageChange:X},{siteID:e(({record:o})=>[t(F,{to:`details/${o.siteID}`},{default:e(()=>[_(J(o.siteID),1)]),_:2},1032,["to"])]),MonitorType:e(({record:o})=>[o.siteSFMode==1?(p(),D("span",xe," MSDK ")):(p(),I(f,{key:1,size:"large"},{default:e(()=>[t(g,{modelValue:o.monitorType,"onUpdate:modelValue":r=>o.monitorType=r,type:"round","checked-color":"green","unchecked-color":"red",onChange:r=>{Y(r,o)}},{checked:e(()=>[_("OSDK")]),unchecked:e(()=>[_("MSDK")]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024))]),siteMode:e(({record:o})=>[_(J(B(ke)[o.flightWay]),1)]),optional:e(({record:o})=>[t(f,{size:"mini"},{default:e(()=>[me("div",ze,[t(ee,{modelValue:o.uploadCurrentInfo.deviceType,"onUpdate:modelValue":r=>o.uploadCurrentInfo.deviceType=r,"allow-clear":!0,size:"small",style:{width:"180px","padding-left":"70px"},placeholder:"\u65E5\u5FD7\u7C7B\u578B"},{default:e(()=>[(p(!0),D(U,null,$(T.value,r=>(p(),I(V,{key:r.title,label:r.title,value:r.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),o.uploadCurrentInfo.deviceType?(p(),I(w,{key:0,type:"primary",size:"mini",onClick:r=>Z(o)},{icon:e(()=>[t(te)]),default:e(()=>[_("\u4E0A\u4F20")]),_:2},1032,["onClick"])):_e("",!0)]),t(w,{type:"primary",size:"small",onClick:r=>B(C).push({path:`edit-site/${o.siteID}`})},{icon:e(()=>[t(oe)]),default:e(()=>[_("\u7F16\u8F91")]),_:2},1032,["onClick"]),t(w,{type:"primary",size:"small",onClick:r=>B(C).push({path:`maintain/${o.siteID}`})},{icon:e(()=>[t(ae)]),default:e(()=>[_("\u7EF4\u62A4")]),_:2},1032,["onClick"]),t(w,{type:"primary",status:"danger",size:"small",onClick:r=>K(o.siteID)},{icon:e(()=>[t(ne)]),default:e(()=>[_(" \u5220\u9664 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["data","columns","pagination"])]),_:1}),t(ie,{visible:d.value,"onUpdate:visible":i[1]||(i[1]=o=>d.value=o),title:"\u8FB9\u7F18\u8BBE\u5907\u7F16\u53F7","title-align":"start",onBeforeOk:j,onClose:Q},{default:e(()=>[t(se,{modelValue:m.value.uploadCurrentInfo.deviceID,"onUpdate:modelValue":i[0]||(i[0]=o=>m.value.uploadCurrentInfo.deviceID=o)},null,8,["modelValue"])]),_:1},8,["visible"])])}}});const at=re(Oe,[["__scopeId","data-v-02a365e1"]]);export{at as default};
