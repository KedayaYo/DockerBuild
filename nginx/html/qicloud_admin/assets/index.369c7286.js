import{_ as T}from"./index.9fa6ecce.js";/* empty css               *//* empty css               *//* empty css               */import{r as w}from"./resource.api.6dab745f.js";/* empty css               */import{d as $,f as y,c as S,o as I,C as p,aE as g,aI as a,aJ as l,aF as N,D as B,aL as U,aK as M,bN as L,bO as J,b6 as W,bT as X,b5 as Y,bU as Z,aX as q,bb as z,b$ as H,bW as Q,bY as x,bo as ee,r as le,m as A,aS as F,aN as _,G as ae,aO as K,bC as oe,b9 as te,aZ as ue,b_ as ne,be as re,b2 as se}from"./arco.35cd4a57.js";/* empty css              *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css                */import"./chart.c690dcf1.js";import"./vue.1515c820.js";const de=$({props:{resourceMode:{type:Number,default:1},parent:{type:Object},permitChangeMode:{type:Boolean,default:!0},isEdit:{type:Boolean,default:!1},resourceItem:{type:Object}},setup(e){const t=y(),m=y({type:e.resourceMode||1,pid:0,name:"",code:"",status:1,weight:1,icon:"",routeName:"",component:"",meta:{isKeepAlive:1,hidden:1,isDelete:1,isIframe:1}}),h=y([{value:1,label:"\u662F"},{value:0,label:"\u5426"}]),C=S(()=>m.value.type===1),c=S(()=>e.permitChangeMode),f=()=>new Promise((r,i)=>{t.value.validate(s=>{var n;console.log(m.value);const k=s?{code:400,message:s.roleName.message}:null;s?i(k):(console.log(e.parent),r({...m.value,pid:((n=e.parent)==null?void 0:n.id)||0}),r({}))})});return I(()=>{e.isEdit&&(m.value=e.resourceItem)}),{formRef:t,resource:m,options:h,ReloadFormComponent:C,handleDisabled:c,handleSubmit:f}}});function ie(e,t,m,h,C,c){const f=L,r=J,i=W,s=X,k=Y,n=Z,E=q,D=z;return p(),g(D,{ref:"formRef",model:e.resource,"label-col-props":{span:1,offset:.1}},{default:a(()=>[l(n,{gutter:8},{default:a(()=>[l(s,{span:12},{default:a(()=>[l(i,{label:"\u7C7B\u578B","label-col-flex":"100px"},{default:a(()=>[l(r,{modelValue:e.resource.type,"onUpdate:modelValue":t[0]||(t[0]=o=>e.resource.type=o),disabled:!e.handleDisabled},{default:a(()=>[l(f,{label:"\u83DC\u5355",value:1}),l(f,{label:"\u6743\u9650",value:2})]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),l(s,{span:12},{default:a(()=>[l(i,{label:"\u83DC\u5355/\u6743\u9650\u540D\u79F0","label-col-flex":"100px"},{default:a(()=>[l(k,{modelValue:e.resource.name,"onUpdate:modelValue":t[1]||(t[1]=o=>e.resource.name=o)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(n,{gutter:8},{default:a(()=>[l(s,{span:12},{default:a(()=>[l(i,{label:"path/code","label-col-flex":"100px"},{default:a(()=>[l(k,{modelValue:e.resource.code,"onUpdate:modelValue":t[2]||(t[2]=o=>e.resource.code=o)},null,8,["modelValue"])]),_:1})]),_:1}),l(s,{span:12},{default:a(()=>[l(i,{label:"\u5E8F\u53F7","label-col-flex":"100px"},{default:a(()=>[l(E,{modelValue:e.resource.weight,"onUpdate:modelValue":t[3]||(t[3]=o=>e.resource.weight=o),min:1,max:1e3},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e.ReloadFormComponent?(p(),g(n,{key:0,gutter:8},{default:a(()=>[l(s,{span:12},{default:a(()=>[l(i,{label:"\u56FE\u6807","label-col-flex":"100px"},{default:a(()=>[l(r,{modelValue:e.resource.type,"onUpdate:modelValue":t[4]||(t[4]=o=>e.resource.type=o)},{default:a(()=>[l(f,{label:"\u83DC\u5355",value:1}),l(f,{label:"\u6743\u9650",value:2})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(s,{span:12},{default:a(()=>[l(i,{label:"\u8DEF\u7531\u540D\u79F0","label-col-flex":"100px"},{default:a(()=>[l(k,{modelValue:e.resource.routeName,"onUpdate:modelValue":t[5]||(t[5]=o=>e.resource.routeName=o)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})):N("",!0),e.ReloadFormComponent?(p(),g(n,{key:1,gutter:8},{default:a(()=>[l(s,{span:12},{default:a(()=>[l(i,{label:"\u7EC4\u4EF6","label-col-flex":"100px"},{default:a(()=>[l(k,{modelValue:e.resource.component,"onUpdate:modelValue":t[6]||(t[6]=o=>e.resource.component=o)},null,8,["modelValue"])]),_:1})]),_:1}),l(s,{span:12},{default:a(()=>[l(i,{label:"\u662F\u5426\u7F13\u5B58","label-col-flex":"100px"},{default:a(()=>[l(r,{modelValue:e.resource.meta.isKeepAlive,"onUpdate:modelValue":t[7]||(t[7]=o=>e.resource.meta.isKeepAlive=o)},{default:a(()=>[(p(!0),B(U,null,M(e.options,o=>(p(),g(f,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})):N("",!0),e.ReloadFormComponent?(p(),g(n,{key:2,gutter:8},{default:a(()=>[l(s,{span:12},{default:a(()=>[l(i,{label:"\u662F\u5426\u9690\u85CF","label-col-flex":"100px"},{default:a(()=>[l(r,{modelValue:e.resource.meta.hidden,"onUpdate:modelValue":t[8]||(t[8]=o=>e.resource.meta.hidden=o)},{default:a(()=>[(p(!0),B(U,null,M(e.options,o=>(p(),g(f,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(s,{span:12},{default:a(()=>[l(i,{label:"\u4E0D\u53EF\u5220\u9664","label-col-flex":"100px"},{default:a(()=>[l(r,{modelValue:e.resource.meta.isDelete,"onUpdate:modelValue":t[9]||(t[9]=o=>e.resource.meta.isDelete=o)},{default:a(()=>[(p(!0),B(U,null,M(e.options,o=>(p(),g(f,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})):N("",!0),e.ReloadFormComponent?(p(),g(i,{key:3,label:"\u662F\u5426iframe","label-col-flex":"100px"},{default:a(()=>[l(r,{modelValue:e.resource.meta.isIframe,"onUpdate:modelValue":t[10]||(t[10]=o=>e.resource.meta.isIframe=o)},{default:a(()=>[(p(!0),B(U,null,M(e.options,o=>(p(),g(f,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):N("",!0)]),_:1},8,["model"])}const me=T(de,[["render",ie]]);function ce(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!ee(e)}const pe=$({name:"Descriptions",props:{resourceItem:{type:Object}},setup(e,t){const m=y([{label:"\u7C7B\u578B",value:"2312312",key:"type",isTag:{color:"red"}},{label:"\u540D\u79F0",value:"",key:"name"},{label:"Code[\u83DC\u5355path]",value:"",key:"code"},{label:"\u5E8F\u53F7",value:"312312312",key:"weight",isTag:{color:"arcoblue"}},{label:"\u8DEF\u7531\u540D\u79F0",value:"",key:"routeName"},{label:"\u7EC4\u4EF6",value:"",key:"component"},{label:"\u521B\u5EFA\u65F6\u95F4",value:"",key:"createTime"},{label:"\u521B\u5EFA\u4EBA",value:"",key:"createUser"},{label:"\u66F4\u65B0\u65F6\u95F4",value:"",key:"updateTime"},{label:"\u66F4\u65B0\u4EBA",value:"",key:"updateUser"}]),h=()=>{Object.keys(e.resourceItem).forEach(C=>{const c=m.value.findIndex(f=>f.key===C);c!==-1&&(m.value[c].value=e.resourceItem[C])})};return I(()=>{h()}),()=>{let C;return l(x,{bordered:!0,column:2},ce(C=m.value.map(c=>l(H,{label:c.label},{default:()=>[c.isTag?l(Q,{color:c.isTag.color},{default:()=>[c.value]}):c.value]})))?C:{default:()=>[C]})}}});var j=(e=>(e[e.show=0]="show",e[e.add=1]="add",e[e.edit=2]="edit",e[e.status=3]="status",e[e.remove=4]="remove",e))(j||{});const fe=$({setup(){const e=y(!1),t=y(!1),m=y(1),h=y(),C=y(!0),c=y(!1),f=y([]),r=y([]),i=y(),s=y("\u65B0\u5EFA\u8D44\u6E90"),k=le([{name:"Form",comName:A(me)},{name:"Descriptions",comName:A(pe)}]),n=y(k[0]),E=y({}),D=()=>{const[u]=k;return n.value=u,s.value="\u65B0\u589E\u8D44\u6E90",C.value=!0,m.value=1,t.value=!1,c.value=!1,!0},o=()=>new Promise(async(u,d)=>{const b=await w.getAll();b.code===0?u(b):(F.error(b),d(b))}),O=(u,d)=>{if(!u||!d||u.id===d)return null;if(u.children)for(let b=0;b<u.children.length;b+=1){const V=u.children[b];if(V.id===d)return u;const v=O(V,d);if(v)return v}return null};I(()=>{o().then(u=>{r.value=u.data.list})});const P=u=>n.value.name==="Descriptions"?(D(),u(),!0):c.value?i.value.handleSubmit().then(async d=>{if((d==null?void 0:d.code)===400)return F.error(d.message),!1;const b=await w.update(d);if(b.code!==0)F.error(b.reason);else return o().then(V=>{r.value=V.data.list}),u(),F.success("\u8BF7\u6C42\u6210\u529F"),!0;return!1}):i.value.handleSubmit().then(async d=>{if((d==null?void 0:d.code)===400)return F.error(d.message),!1;const b=await w.create(d);if(b.code!==0)F.error(b.reason);else return o().then(V=>{r.value=V.data.list}),u(),F.success("\u8BF7\u6C42\u6210\u529F"),!0;return!1}),R=u=>{u.children&&u.children.length!==0?m.value=u.children[0].type:m.value=u.type};return{visible:e,hideCancel:t,checkedKeys:f,ModalTitle:s,dataSource:r,parent:h,isEdit:c,resourceMode:m,permitChangeMode:C,AsynComponent:i,FunctionType:j,asynComponents:k,CurrentComponent:n,currentResource:E,treeFunctionControl:async(u,d)=>{switch(d){case 0:s.value="\u67E5\u770B\u8D44\u6E90\u8BE6\u60C5",t.value=!0;const[,b]=k;n.value=b,w.getOne(u.id).then(v=>{E.value=v.data,e.value=!0}).catch(v=>{F.error(v)});break;case 1:s.value="\u65B0\u589E\u8D44\u6E90",R(u),h.value=u,C.value=m.value===1,e.value=!0;break;case 2:s.value="\u7F16\u8F91\u8D44\u6E90",c.value=!0,R(u);const[V]=r.value.filter(v=>O(v,u.id));h.value=V,C.value=m.value===1,w.getOne(u.id).then(v=>{E.value=v.data,e.value=!0}).catch(v=>{F.error(v)});break;case 4:Promise.resolve().then(async()=>await w.delete(u.id)).then(v=>{v.code!==0?F.error(v.reason):(o().then(G=>{r.value=G.data.list}),F.success("\u8BF7\u6C42\u6210\u529F"))});break}},reloadAsyncComponent:D,handleGetComponentSubmit:P}}});const be={class:"role-management-wrap container"},ve={class:"plus-wrap",style:{position:"absolute",right:"10px"}};function ye(e,t,m,h,C,c){const f=te,r=ue,i=ne,s=re,k=se;return p(),B("div",be,[l(s,{style:{width:"100%"}},{title:a(()=>[_("\u8D44\u6E90\u7BA1\u7406")]),extra:a(()=>[l(f,{onClick:t[0]||(t[0]=n=>e.visible=!0)},{default:a(()=>[_("\u65B0\u589E")]),_:1})]),default:a(()=>[l(i,{"checked-keys":e.checkedKeys,"onUpdate:checkedKeys":t[1]||(t[1]=n=>e.checkedKeys=n),class:"resource-tree","block-node":"",data:e.dataSource,"field-names":{key:"id",title:"name",icon:"customIcon"}},{extra:a(n=>[ae("div",ve,[l(r,{type:"text",onClick:()=>e.treeFunctionControl(n,e.FunctionType.show)},{default:a(()=>[_("\u67E5\u770B ")]),_:2},1032,["onClick"]),n.type===1?(p(),g(r,{key:0,type:"text",status:"success",onClick:()=>e.treeFunctionControl(n,e.FunctionType.add)},{default:a(()=>[_("\u65B0\u589E ")]),_:2},1032,["onClick"])):(p(),g(r,{key:1,type:"text",status:n.status===-1?"success":"warning",onClick:E=>e.treeFunctionControl(n,e.FunctionType.status)},{default:a(()=>[_(K(n.status===-1?"\u542F\u7528":"\u7981\u7528"),1)]),_:2},1032,["status","onClick"])),l(r,{type:"text",status:"warning",onClick:()=>e.treeFunctionControl(n,e.FunctionType.edit)},{default:a(()=>[_("\u7F16\u8F91 ")]),_:2},1032,["onClick"]),l(r,{type:"text",status:"danger",onClick:()=>e.treeFunctionControl(n,e.FunctionType.remove)},{default:a(()=>[_("\u5220\u9664 ")]),_:2},1032,["onClick"])])]),_:1},8,["checked-keys","data"])]),_:1}),l(k,{visible:e.visible,"onUpdate:visible":t[2]||(t[2]=n=>e.visible=n),"title-align":"start","unmount-on-close":!0,"mask-closable":!1,"hide-cancel":e.hideCancel,"on-before-ok":e.reloadAsyncComponent,"on-before-cancel":e.reloadAsyncComponent,width:"800px",onBeforeOk:e.handleGetComponentSubmit},{title:a(()=>[_(K(e.ModalTitle),1)]),default:a(()=>[(p(),g(oe(e.CurrentComponent.comName),{ref:"AsynComponent","resource-item":e.currentResource,"resource-mode":e.resourceMode,parent:e.parent,"is-edit":e.isEdit,"permit-change-mode":e.permitChangeMode},null,8,["resource-item","resource-mode","parent","is-edit","permit-change-mode"]))]),_:1},8,["visible","hide-cancel","on-before-ok","on-before-cancel","onBeforeOk"])])}const Oe=T(fe,[["render",ye],["__scopeId","data-v-b4d36756"]]);export{Oe as default};
