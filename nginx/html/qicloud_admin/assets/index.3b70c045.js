var P=Object.defineProperty;var Q=(o,t,d)=>t in o?P(o,t,{enumerable:!0,configurable:!0,writable:!0,value:d}):o[t]=d;var N=(o,t,d)=>(Q(o,typeof t!="symbol"?t+"":t,d),d);import{H as M,_ as V}from"./index.9fa6ecce.js";/* empty css              *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               */import{d as X,c as H,C as v,D,G as a,aL as x,aK as C,aE as B,aI as e,aO as c,aJ as n,aN as u,aF as z,bW as k,ba as G,aZ as O,be as $,bl as Y,bm as ee,aS as y,bZ as te,bG as ne,f as b,r as se,o as oe,b as le,bC as ae,bN as ie,bO as ue,b6 as re,bb as ce,b2 as de}from"./arco.35cd4a57.js";import{s as _e}from"./site.20be6969.js";import{g as E,R as w,h as R,i as L,f as me}from"./index.571baf06.js";/* empty css                *//* empty css                *//* empty css                *//* empty css               */import"./chart.c690dcf1.js";import"./vue.1515c820.js";class pe{constructor(){N(this,"uri","/batch_missions")}get({page:t,size:d}){return M.get(`${this.uri}/page`,{page:t,size:d})}insert({missionID:t,returnMode:d,siteID:s,endSiteID:F}){return M.post(`${this.uri}`,{missionID:t,returnMode:d,siteID:s,endSiteID:F})}start({missionBatch:t,type:d=1}){return M.post(`${this.uri}/control`,{missionBatch:t,type:d})}}const U=new pe;class fe{constructor(){N(this,"uri","/cruise_routes")}get(t){return M.get(`${this.uri}?siteID=${t}`)}}const ve=new fe,Fe={"aria-hidden":"true",class:"svg-icon"},ge=["href","fill"],be=X({__name:"index",props:{prefix:{type:String,default:"icon"},iconClass:{type:String,required:!1},color:{type:String,default:""}},setup(o){const t=o,d=H(()=>`#${t.prefix}-${t.iconClass}`);return(s,F)=>(v(),D("svg",Fe,[a("use",{href:d.value,fill:o.color},null,8,ge)]))}});const he=V(be,[["__scopeId","data-v-f5fd3c3f"]]);function Be(o,t){window.localStorage.setItem(o,t)}function De(o){return window.localStorage.getItem(o)}const Se={name:"MissionGrid",props:{source:{type:Array,default:()=>[],required:!0}},emits:["start","remove"],setup(o,{emit:t}){return{MissionType:E,ReturnMode:w,MissionSource:R,MissionStatus:L,startMission:F=>t("start",F),handleRemove:F=>t("remove",F)}}};const I=o=>(Y("data-v-0f81ca08"),o=o(),ee(),o),ye={class:"grid-list-wrapper"},Ie={class:"header-wrap"},Ae=I(()=>a("strong",null,"\u540D\u79F0\uFF1A",-1)),xe=I(()=>a("strong",null,"\u8D77\u70B9\u7AD9\uFF1A",-1)),Ce=I(()=>a("strong",null,"\u521B\u5EFA\u65F6\u95F4\uFF1A",-1)),we=I(()=>a("strong",null,"\u5F00\u59CB\u65F6\u95F4\uFF1A",-1)),Me=I(()=>a("strong",null,"\u7ED3\u675F\u65F6\u95F4\uFF1A",-1)),ke=I(()=>a("strong",null,"\u8D77\u98DE\u65F6\u95F4\uFF1A",-1)),Ee=I(()=>a("strong",null,"\u964D\u843D\u65F6\u95F4\uFF1A",-1));function Ve(o,t,d,s,F,f){const _=k,m=G,S=O,g=$;return v(),D("div",ye,[(v(!0),D(x,null,C(d.source,r=>(v(),B(g,{key:r.missionBatch,class:"grid-item-wrap"},{title:e(()=>[a("div",Ie,[a("h4",null,c(r.missionBatch),1),n(m,{class:"auxiliary"},{default:e(()=>[a("span",null,[u(" \u6765\u6E90: "),n(_,{color:"#7816ff"},{default:e(()=>[u(c(s.MissionSource[r.missionSource]),1)]),_:2},1024)]),a("span",null,[u(" \u4EFB\u52A1\u72B6\u6001: "),n(_,{color:"#86909c"},{default:e(()=>[u(c(s.MissionStatus[r.missionBatchState]||"\u672A\u77E5"),1)]),_:2},1024)]),a("span",null,[u(" \u6D41\u7A0B\u72B6\u6001: "),n(_,{color:"#165dff"},{default:e(()=>[u(c(r.flowState),1)]),_:2},1024)])]),_:2},1024)])]),extra:e(()=>[n(m,{class:"function-area-right"},{default:e(()=>[n(S,{type:"text",onClick:l=>s.startMission(r.missionBatch)},{default:e(()=>[u(" \u7ACB\u5373\u4E0B\u53D1 ")]),_:2},1032,["onClick"]),z("",!0)]),_:2},1024)]),default:e(()=>[n(m,{direction:"vertical",size:"large"},{default:e(()=>[n(m,null,{default:e(()=>[Ae,u(" "+c(r.missionName),1)]),_:2},1024),n(m,null,{default:e(()=>[a("div",null,[xe,u(" "+c(r.siteID),1)])]),_:2},1024),n(m,null,{default:e(()=>[Ce,u(" "+c(r.createTime),1)]),_:2},1024),n(m,null,{default:e(()=>[a("div",null,[we,u(" "+c(r.missionStartTime),1)]),a("div",null,[Me,u(" "+c(r.missionEndTime),1)])]),_:2},1024),n(m,null,{default:e(()=>[a("div",null,[ke,u(" "+c(r.UAVStartTime),1)]),a("div",null,[Ee,u(" "+c(r.UAVEndTime),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))])}const Te=V(Se,[["render",Ve],["__scopeId","data-v-0f81ca08"]]);var q=function(o){return o[o.red=1]="red",o[o.green=2]="green",o}(q||{}),Z=function(o){return o[o.green=1]="green",o[o.red=2]="red",o}(Z||{});const Ne={name:"MissionList",props:{source:{type:Array,required:!0,default:()=>[]}},emits:["start","remove"],setup(o,{emit:t}){return{columns:[{title:"\u7F16\u53F7",dataIndex:"missionID"},{title:"\u5E8F\u5217\u53F7",dataIndex:"missionBatch"},{title:"\u540D\u79F0",dataIndex:"missionName"},{title:"\u4EFB\u52A1\u7C7B\u578B",dataIndex:"missionType",render({record:f}){return n(k,{color:q[f.missionType]},{default:()=>[E[f.missionType]]})}},{title:"\u8FD4\u822A\u65B9\u5F0F",dataIndex:"returnMode",render({record:f}){return n(k,{color:Z[f.returnMode]},{default:()=>[w[f.returnMode]]})}}],MissionType:E,ReturnMode:w,MissionSource:R,MissionStatus:L,startMission:f=>t("start",f),remove:f=>{y.error(f)}}}},Ue={class:"site-info"},ze={class:"site-info"},Ge={class:"site-info"};function Oe(o,t,d,s,F,f){const _=te,m=k,S=O,g=G,r=ne;return v(),B(r,{data:d.source,bordered:{wrapper:!0,cell:!0}},{columns:e(()=>[n(_,{title:"\u7F16\u53F7","data-index":"missionID",align:"center"}),n(_,{title:"\u5E8F\u5217\u53F7","data-index":"missionBatch",align:"center"}),n(_,{title:"\u540D\u79F0","data-index":"missionName",align:"center"}),n(_,{title:"\u7C7B\u578B",align:"center"},{cell:e(({record:l})=>[n(m,null,{default:e(()=>[u(c(s.MissionType[l.missionType]),1)]),_:2},1024)]),_:1}),n(_,{title:"\u8FD4\u822A\u65B9\u5F0F",align:"center"},{cell:e(({record:l})=>[n(m,null,{default:e(()=>[u(c(s.ReturnMode[l.returnMode]),1)]),_:2},1024)]),_:1}),n(_,{title:"\u8D77\u70B9\u7AD9",align:"center"},{cell:e(({record:l})=>[a("div",Ue,[a("p",null,[a("b",null,c(l.siteID),1)]),a("ul",null,[a("li",null,c(l.startHiveID),1),a("li",null,c(l.endHiveID),1)])])]),_:1}),n(_,{title:"\u98DE\u884C\u65F6\u95F4",align:"center"},{cell:e(({record:l})=>[a("div",ze,[a("ul",null,[a("li",null,"\u8D77\u98DE\uFF1A"+c(l.UAVStartTime),1),a("li",null,"\u964D\u843D\uFF1A"+c(l.UAVEndTime),1)])])]),_:1}),n(_,{title:"\u4EFB\u52A1\u65F6\u95F4",align:"center"},{cell:e(({record:l})=>[a("div",Ge,[a("ul",null,[a("li",null,"\u5F00\u59CB\uFF1A"+c(l.missionStartTime),1),a("li",null,"\u7ED3\u675F\uFF1A"+c(l.missionEndTime),1)])])]),_:1}),n(_,{title:"\u4EFB\u52A1\u4FE1\u606F",align:"center"},{cell:e(({record:l})=>[u(" \u6765\u6E90\uFF1A"),n(m,null,{default:e(()=>[u(c(s.MissionSource[l.missionSource]),1)]),_:2},1024),u(" \u72B6\u6001\uFF1A"),n(m,null,{default:e(()=>[u(c(s.MissionStatus[l.missionBatchState]),1)]),_:2},1024)]),_:1}),n(_,{title:"\u6D41\u7A0B\u72B6\u6001",align:"center"},{cell:e(({record:l})=>[n(m,null,{default:e(()=>[u(c(l.flowState),1)]),_:2},1024)]),_:1}),n(_,{title:"\u64CD\u4F5C","data-index":"optional",align:"center"},{cell:e(({record:l})=>[n(g,null,{default:e(()=>[n(S,{type:"primary",size:"mini",onClick:A=>s.startMission(l.missionBatch)},{default:e(()=>[u("\u7ACB\u5373\u4E0B\u53D1 ")]),_:2},1032,["onClick"]),z("",!0)]),_:2},1024)]),_:1})]),_:1},8,["data"])}const Re=V(Ne,[["render",Oe]]),Le={components:{SvgIcon:he,Grid:Te,List:Re},setup(){const o=b(De("view")||"Grid"),t=b(["Grid","List"]),d=b(1e4),s=b(),F=b(!1),f=se({missionID:"",returnMode:1,siteID:"",endSiteID:""}),_=b([]),m=b(me(w)),S=H(()=>f.returnMode===2),g=b([]),r=b([]),l=async()=>{const p=await U.get({page:1,size:30});p.code===0?r.value=p.data.list:y.error("\u8BF7\u6C42\u5931\u8D25")},A=async p=>{const h=await ve.get(p);_.value=h.data.list},T=async()=>{const p=await _e.get({page:1,size:1e3});g.value=p.data.list.map(h=>({value:h.siteID,label:h.siteName}))},i=async p=>{await A(p)},J=async()=>{const p=await U.insert(f);p.code!==0?y.error(p.reason):(y.success(p.reason),l())},K=p=>{o.value=p,Be("view",p)},W=async p=>{const h=await U.start({missionBatch:p,type:1});h.code!==0?y.warning(h.reason):(l(),y.success(h.reason))},j=p=>{y.success("HandleClickDelete")};return oe(()=>{s.value=setInterval(()=>l(),d.value)}),le(()=>{clearInterval(s.value),s.value=null}),l(),T(),{view:o,views:t,visible:F,publishMission:f,dataSource:r,missions:_,returnOptions:m,toModel:S,sites:g,MissionType:E,ReturnMode:w,MissionSource:R,MissionStatus:L,handleSelectStartSite:i,handleSubmit:J,remove:j,handleChangeView:K,handleStartMission:W}}};const He={class:"mission-wrapper container"};function $e(o,t,d,s,F,f){const _=O,m=G,S=$,g=ie,r=ue,l=re,A=ce,T=de;return v(),D("div",He,[n(S,{title:"\u4EFB\u52A1\u5217\u8868",class:"grid-card-wrap"},{extra:e(()=>[n(m,null,{default:e(()=>[n(_,{size:"small",onClick:t[0]||(t[0]=i=>s.visible=!0)},{default:e(()=>[u("\u65B0\u589E")]),_:1}),n(_,{size:"small",onClick:t[1]||(t[1]=i=>s.handleChangeView("Grid"))},{default:e(()=>[u(" \u7F51\u683C ")]),_:1}),n(_,{size:"small",onClick:t[2]||(t[2]=i=>s.handleChangeView("List"))},{default:e(()=>[u(" \u8868\u683C ")]),_:1})]),_:1})]),default:e(()=>[(v(),B(ae(s.view),{source:s.dataSource,onStart:s.handleStartMission,onRemove:s.remove},null,40,["source","onStart","onRemove"]))]),_:1}),n(T,{visible:s.visible,"onUpdate:visible":t[7]||(t[7]=i=>s.visible=i),title:"\u65B0\u589E\u4EFB\u52A1","title-align":"start",onBeforeOk:s.handleSubmit},{default:e(()=>[n(A,{model:s.publishMission,"label-col-props":{span:4}},{default:e(()=>[n(l,{label:"\u8D77\u70B9"},{default:e(()=>[n(r,{modelValue:s.publishMission.siteID,"onUpdate:modelValue":t[3]||(t[3]=i=>s.publishMission.siteID=i),onChange:s.handleSelectStartSite},{default:e(()=>[(v(!0),D(x,null,C(s.sites,i=>(v(),B(g,{key:i.value,value:i.value,label:i.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1}),n(l,{label:"\u4EFB\u52A1"},{default:e(()=>[n(r,{modelValue:s.publishMission.missionID,"onUpdate:modelValue":t[4]||(t[4]=i=>s.publishMission.missionID=i)},{default:e(()=>[(v(!0),D(x,null,C(s.missions,i=>(v(),B(g,{key:i.missionID,value:i.missionID,label:i.missionName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(l,{label:"\u8FD4\u822A\u65B9\u5F0F"},{default:e(()=>[n(r,{modelValue:s.publishMission.returnMode,"onUpdate:modelValue":t[5]||(t[5]=i=>s.publishMission.returnMode=i)},{default:e(()=>[(v(!0),D(x,null,C(s.returnOptions,i=>(v(),B(g,{key:i.title,value:i.value,label:i.title},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),s.toModel?(v(),B(l,{key:0,label:"\u7EC8\u70B9"},{default:e(()=>[n(r,{modelValue:s.publishMission.endSiteID,"onUpdate:modelValue":t[6]||(t[6]=i=>s.publishMission.endSiteID=i)},{default:e(()=>[(v(!0),D(x,null,C(s.sites,i=>(v(),B(g,{key:i.value,value:i.value,label:i.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})):z("",!0)]),_:1},8,["model"])]),_:1},8,["visible","onBeforeOk"])])}const ct=V(Le,[["render",$e],["__scopeId","data-v-7d4022fd"]]);export{ct as default};
