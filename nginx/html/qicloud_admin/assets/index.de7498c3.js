import{g as x}from"./index.9fa6ecce.js";/* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css                *//* empty css                *//* empty css                *//* empty css               *//* empty css               *//* empty css               */import{d as L,f as i,r as h,o as O,C as v,aE as b,aI as u,aJ as e,D as w,aL as S,aK as T,b5 as z,b6 as R,bT as W,bU as Z,bN as q,bO as G,bb as M,m as j,aN as E,aO as J,bC as K,bW as H,aZ as $,ba as Q,aS as V,b9 as X,bG as Y,be as ee,b2 as ae}from"./arco.35cd4a57.js";import{f as ue,j as P}from"./index.571baf06.js";/* empty css              *//* empty css               */import{t as te}from"./terrace.management.1f90c17c.js";import{r as le}from"./role.management.9e0cf398.js";import"./chart.c690dcf1.js";import"./vue.1515c820.js";const U=(p,r)=>{const c=/^[\w\u4e00-\u9fa5]{2,16}$/;return p?c.test(p)?r():r("\u652F\u6301 _\u3001\u6587\u5B57\u3001\u6570\u5B57\u3001\u5B57\u6BCD,\u4E14\u957F\u5EA62-16"):r("\u8BF7\u586B\u5199\u7528\u6237\u540D\u79F0")},oe=(p,r)=>{const c=/^(?:(?:\+|00)86)?1\d{10}$/;return p?c.test(p)?r():r("\u8BF7\u586B\u5199\u6B63\u786E\u624B\u673A\u53F7"):r("\u624B\u673A\u53F7\u4E0D\u80FD\u4E3A\u7A7A")},ne=(p,r)=>{const c=/^(?![a-zA-Z]+$)(?![A-Z0-9]+$)(?![A-Z\W_!@#$%^&*`~()-+=]+$)(?![a-z0-9]+$)(?![a-z\W_!@#$%^&*`~()-+=]+$)(?![0-9\W_!@#$%^&*`~()-+=]+$)[a-zA-Z0-9\W_!@#$%^&*`~()-+=]/;return p?c.test(p)?r():r("\u81F3\u5C11\u4E00\u4E2A\u5927\u5199\u5B57\u6BCD\u3001\u4E00\u4E2A\u5C0F\u5199\u5B57\u6BCD\u3001\u6570\u5B57\u3001\u5B57\u7B26"):r("\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A")},re=L({__name:"Form",props:{current:{type:Object,default:()=>({})}},setup(p,{expose:r}){const c=p,F=i(),D=i(),_=i(),A=i(ue(P)),y=h({realName:[{required:!0,message:"\u59D3\u540D\u4E0D\u80FD\u4E3A\u7A7A"},{validator:U}],userName:[{required:!0,message:"\u89D2\u8272\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"},{validator:U}],password:[{required:!0,message:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A"},{validator:ne}],phone:[{required:!0,message:"\u624B\u673A\u53F7\u4E0D\u80FD\u4E3A\u7A7A"},{validator:oe}]}),o=i({realName:"",phone:"",userName:"",password:"",roleIDs:[],PLATIDS:[],status:1,address:""}),g=()=>new Promise((m,n)=>{F.value.validate(a=>{if(a){let l="";Object.keys(a).forEach(d=>{l+=`${a[d].message}\u3001`}),n(a?{code:400,message:l}:null)}else m(o)})}),N=async()=>{const m=await te.getAll();D.value=m.data},I=async()=>{const m=await le.getAll();_.value=m.data},k=m=>{JSON.stringify(m)!=="{}"&&(o.value=m,o.value.userID=m.id)};return O(()=>{N(),I(),k(c.current)}),r({handleSubmit:g}),(m,n)=>{const a=z,l=R,s=W,d=Z,f=q,B=G,C=M;return v(),b(C,{ref_key:"formRef",ref:F,rules:y,model:o.value,layout:"vertical","label-col-props":{span:4}},{default:u(()=>[e(d,{gutter:8},{default:u(()=>[e(s,{span:12},{default:u(()=>[e(l,{field:"realName",label:"\u59D3\u540D"},{default:u(()=>[e(a,{modelValue:o.value.realName,"onUpdate:modelValue":n[0]||(n[0]=t=>o.value.realName=t),placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:u(()=>[e(l,{field:"phone",label:"\u7535\u8BDD"},{default:u(()=>[e(a,{modelValue:o.value.phone,"onUpdate:modelValue":n[1]||(n[1]=t=>o.value.phone=t),placeholder:"\u8BF7\u8F93\u5165\u7535\u8BDD"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d,{gutter:8},{default:u(()=>[e(s,{span:12},{default:u(()=>[e(l,{field:"userName",label:"\u7528\u6237\u540D"},{default:u(()=>[e(a,{modelValue:o.value.userName,"onUpdate:modelValue":n[2]||(n[2]=t=>o.value.userName=t),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:u(()=>[e(l,{field:"password",label:"\u5BC6\u7801"},{default:u(()=>[e(a,{modelValue:o.value.password,"onUpdate:modelValue":n[3]||(n[3]=t=>o.value.password=t),placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d,{gutter:8},{default:u(()=>[e(s,{span:12},{default:u(()=>[e(l,{label:"\u89D2\u8272"},{default:u(()=>[e(B,{modelValue:o.value.roleIDs,"onUpdate:modelValue":n[4]||(n[4]=t=>o.value.roleIDs=t),multiple:"","max-tag-count":1,placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"},{default:u(()=>[(v(!0),w(S,null,T(_.value,t=>(v(),b(f,{key:t.roleCode,label:t.roleName,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:u(()=>[e(l,{label:"\u5E73\u53F0"},{default:u(()=>[e(B,{modelValue:o.value.PLATIDS,"onUpdate:modelValue":n[5]||(n[5]=t=>o.value.PLATIDS=t),multiple:"","max-tag-count":1,placeholder:"\u8BF7\u8F93\u5165\u5E73\u53F0\u540D\u79F0"},{default:u(()=>[(v(!0),w(S,null,T(D.value,t=>(v(),b(f,{key:t.PLATCode,label:t.PLATName,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d,{gutter:8},{default:u(()=>[e(s,{span:12},{default:u(()=>[e(l,{label:"\u72B6\u6001"},{default:u(()=>[e(B,{modelValue:o.value.status,"onUpdate:modelValue":n[6]||(n[6]=t=>o.value.status=t),placeholder:"\u8BF7\u8F93\u5165\u72B6\u6001"},{default:u(()=>[(v(!0),w(S,null,T(A.value,t=>(v(),b(f,{key:t.title,value:t.value,label:t.title},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:u(()=>[e(l,{label:"\u4F4F\u5740"},{default:u(()=>[e(a,{modelValue:o.value.address,"onUpdate:modelValue":n[7]||(n[7]=t=>o.value.address=t),placeholder:"\u8BF7\u8F93\u5165\u4F4F\u5740"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"])}}}),se={class:"system-user-management-wrap container"},ke=L({__name:"index",setup(p){const r=i(!1),c=i(!1),F=i(),D=i(),_=i(),A=i("\u65B0\u589E\u7528\u6237"),y=h([{name:"Form",comName:j(re)}]),o=i(y[0]),g=async()=>{const a=await x.getAll({page:1,size:4e3});a.code===0&&(F.value=a.data.list)},N=a=>{var l,s;_.value={...a,roleIDs:(l=a.roleList)==null?void 0:l.map(({id:d})=>d),PLATIDS:(s=a.PLATList)==null?void 0:s.map(({id:d})=>d)},c.value=!0,A.value="\u4FEE\u6539\u7528\u6237",r.value=!0},I=async a=>{(await x.remove(a.id)).code===0?(g(),V.success("\u8BF7\u6C42\u6210\u529F")):V.error("\u8BF7\u6C42\u5931\u8D25")},k=[{dataIndex:"userName",title:"\u7528\u6237\u540D"},{dataIndex:"realName",title:"\u59D3\u540D"},{dataIndex:"password",title:"\u5BC6\u7801"},{dataIndex:"phone",title:"\u624B\u673A\u53F7",align:"center"},{dataIndex:"status",title:"\u72B6\u6001",align:"center",render:({record:a})=>e(H,{color:a.status?"green":"red"},{default:()=>[P[a.status]]})},{dataIndex:"createTime",title:"\u521B\u5EFA\u65F6\u95F4",align:"center"},{dataIndex:"updateTime",title:"\u66F4\u65B0\u65F6\u95F4",align:"center"},{dataIndex:"operation",title:"\u64CD\u4F5C",align:"center",render:({record:a})=>e(Q,{size:"mini"},{default:()=>[e($,{type:"primary",size:"mini",onClick:()=>N(a)},{default:()=>[E("\u4FEE\u6539")]}),e($,{type:"primary",status:"danger",size:"mini",onClick:()=>I(a)},{default:()=>[E("\u5220\u9664")]})]})}],m=()=>{const[a]=y;return o.value=a,A.value="\u65B0\u589E\u7528\u6237",c.value=!1,_.value={},!0},n=async a=>D.value.handleSubmit().then(async l=>new Promise((s,d)=>{x[c.value?"update":"create"](l.value).then(async f=>{f.code===0?(r.value=!1,await g(),V.success("\u8BF7\u6C42\u6210\u529F"),s(f),a()):d(new Error("\u9519\u8BEF"))}).catch(f=>{console.log(f)})})).catch(l=>(V.error(l.message),!1));return g(),(a,l)=>{const s=X,d=Y,f=ee,B=ae;return v(),w("div",se,[e(f,{title:"\u7528\u6237\u7BA1\u7406",style:{width:"100%"}},{extra:u(()=>[e(s,{onClick:l[0]||(l[0]=C=>r.value=!0)},{default:u(()=>[E("\u65B0\u589E")]),_:1})]),default:u(()=>[e(d,{data:F.value,columns:k},null,8,["data"])]),_:1}),e(B,{visible:r.value,"onUpdate:visible":l[1]||(l[1]=C=>r.value=C),width:"40vw",title:"\u65B0\u589E\u7528\u6237","title-align":"start","modal-class":"async-modal-wrap","unmount-on-close":!0,"mask-closable":!1,"on-before-ok":m,"on-before-cancel":m,onBeforeOk:n},{title:u(()=>[E(J(A.value),1)]),default:u(()=>[(v(),b(K(o.value.comName),{ref_key:"AsyncComponent",ref:D,current:_.value},null,8,["current"]))]),_:1},8,["visible"])])}}});export{ke as default};
