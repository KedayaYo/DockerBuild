import{_ as X}from"./index.9fa6ecce.js";/* empty css              *//* empty css               *//* empty css                *//* empty css               *//* empty css                */import{u as Y}from"./upload.aab3b5b0.js";/* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               */import{d as Z,f as E,aG as y,C as s,D as c,aJ as e,aI as t,aL as B,aK as x,aE as F,G as i,aF as j,E as Q,aN as S,aS as v,bN as W,bO as ee,b6 as ue,b5 as ae,bV as le,ba as te,aX as oe,be as se,bH as de,bF as ne,aZ as re,bT as ie,bU as me,bb as pe,bl as ce,bm as _e}from"./arco.35cd4a57.js";import{g as ve}from"./vue.1515c820.js";import{f as fe,D as Ee}from"./index.571baf06.js";import{d as w}from"./device.f5d47a6f.js";import"./chart.c690dcf1.js";const M=_=>(ce("data-v-7292f8ab"),_=_(),_e(),_),Fe={class:"edit-device-wrapper container"},ge={key:0},be={class:"flex flex-row items-center"},Ae=M(()=>i("label",null,"\u6700\u5C0F\u503C",-1)),De={class:"flex flex-row items-center"},Ce=M(()=>i("label",null,"\u6700\u5927\u503C",-1)),Ve={key:0,class:"arco-upload-list-picture custom-upload-avatar"},he=["src"],ye={class:"arco-upload-list-picture-mask"},Be={key:1,class:"arco-upload-picture-card"},xe={class:"arco-upload-picture-card-text"},Se=2,we=Z({__name:"EditDevice",props:{id:{type:String,default:()=>""}},setup(_){const D=_,g=D.id?window.sessionStorage.getItem(D.id):null,k=ve(),d=E(),C=E(),U={modelName:[{required:!0,message:"\u8BBE\u5907\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],modelCode:[{required:!0,message:"\u8BBE\u5907\u578B\u53F7\u4E0D\u80FD\u4E3A\u7A7A"}],modelType:[{required:!0,message:"\u8BBE\u5907\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A"}],uavMaxFlightHeight:[{required:!0,validator:(r,a)=>{r?a():a("\u65E0\u4EBA\u673A\u98DE\u884C\u9AD8\u5EA6\u4E0D\u80FD\u4E3A\u7A7A"),r>500?a("\u65E0\u4EBA\u673A\u98DE\u884C\u9AD8\u5EA6\u4E0D\u80FD\u5927\u4E8E500"):a()}}],brand:[{required:!0,message:"\u751F\u4EA7\u5546\u4E0D\u80FD\u4E3A\u7A7A"}]},u=E({modelName:"",modelCode:"",modelType:1,brand:"",remark:"",appearanceUrl:"",uavMinFlightSpeed:1,uavMaxFlightSpeed:15,uavMaxFlightHeight:"",modelProperty:{metas:[]}});g&&(u.value=JSON.parse(g));const I=E(fe(Ee)),N=(r,a)=>{d.value={...a}},T=r=>{v.success("")},P=async()=>{if(await C.value.validate())return;if(u.value.modelType===1&&(u.value.uavMinFlightSpeed>u.value.uavMaxFlightSpeed||u.value.uavMinFlightSpeed===u.value.uavMaxFlightSpeed)){v.error("\u65E0\u4EBA\u673A\u6700\u5C0F\u503C\u4E0D\u80FD\u5927\u4E8E\u6700\u5927\u503C");return}const a={...u.value,modelProperty:JSON.stringify(u.value.modelProperty)},m=g?await w.updateDeviceModel(a):await w.create(a);m.code===0?(v.success("\u8BF7\u6C42\u6210\u529F"),k.go(-1)):v.error(m.reason)},q=async(r,a)=>{const{fileItem:m}=r,p=new FormData;p.append("fileName",a.modelCode),p.append("photoType",Se),p.append("file",m.file);const o=await Y.upload(p);o.code===320760101&&v.success(o.msg);const n=new FileReader;n.readAsDataURL(m.file),n.onload=function(f){d.value.url=f.target.result}};return(r,a)=>{const m=W,p=ee,o=ue,n=ae,f=le,V=te,H=oe,b=se,O=y("IconEdit"),R=y("IconPlus"),J=de,L=ne,h=re,$=ie,z=me,G=pe;return s(),c("div",Fe,[e(G,{ref_key:"formRef",ref:C,model:u.value,layout:"vertical",rules:U,onSubmit:P},{default:t(()=>[e(b,{title:"\u57FA\u672C\u4FE1\u606F"},{default:t(()=>[e(o,{label:"\u7C7B\u578B",field:"modelType","validate-trigger":["change","input"]},{default:t(()=>[e(p,{modelValue:u.value.modelType,"onUpdate:modelValue":a[0]||(a[0]=l=>u.value.modelType=l)},{default:t(()=>[(s(!0),c(B,null,x(I.value,l=>(s(),F(m,{key:l.value,value:l.value,label:l.title},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(o,{label:"\u540D\u79F0",field:"modelName","validate-trigger":["change","input"]},{default:t(()=>[e(n,{modelValue:u.value.modelName,"onUpdate:modelValue":a[1]||(a[1]=l=>u.value.modelName=l)},null,8,["modelValue"])]),_:1}),e(o,{label:"\u578B\u53F7",field:"modelCode"},{default:t(()=>[e(n,{modelValue:u.value.modelCode,"onUpdate:modelValue":a[2]||(a[2]=l=>u.value.modelCode=l)},null,8,["modelValue"])]),_:1}),u.value.modelType===1?(s(),c("div",ge,[e(o,{label:"\u65E0\u4EBA\u673A\u98DE\u884C\u901F\u5EA6\u8303\u56F4"},{default:t(()=>[e(V,{direction:"vertical",size:"large",class:"set-flight-space"},{default:t(()=>[i("div",be,[Ae,e(f,{"model-value":u.value.uavMinFlightSpeed,"onUpdate:modelValue":a[3]||(a[3]=l=>u.value.uavMinFlightSpeed=l),"show-ticks":!0,step:.1,min:.5,max:15,"show-input":""},null,8,["model-value"])]),i("div",De,[Ce,e(f,{"model-value":u.value.uavMaxFlightSpeed,"onUpdate:modelValue":a[4]||(a[4]=l=>u.value.uavMaxFlightSpeed=l),"show-ticks":!0,step:.1,min:.5,max:15,"show-input":""},null,8,["model-value"])])]),_:1})]),_:1}),e(o,{label:"\u65E0\u4EBA\u673A\u6700\u5927\u5DE1\u822A\u9AD8\u5EA6",field:"uavMaxFlightHeight"},{default:t(()=>[e(H,{modelValue:u.value.uavMaxFlightHeight,"onUpdate:modelValue":a[5]||(a[5]=l=>u.value.uavMaxFlightHeight=l),min:-200,max:500},null,8,["modelValue"])]),_:1})])):j("",!0),e(o,{label:"\u5382\u5BB6",field:"brand"},{default:t(()=>[e(n,{modelValue:u.value.brand,"onUpdate:modelValue":a[6]||(a[6]=l=>u.value.brand=l),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})]),_:1}),e(b,{title:"\u6A21\u578B\u56FE"},{default:t(()=>[e(o,null,{default:t(()=>[u.value.appearanceUrl?(s(),F(L,{key:1,src:u.value.appearanceUrl},null,8,["src"])):(s(),F(J,{key:0,"file-list":d.value?[d.value]:[],"show-file-list":!1,"custom-request":l=>{q(l,u.value)},onSuccess:T,onChange:N},{"upload-button":t(()=>[i("div",{class:Q(`arco-upload-list-item${d.value&&d.value.status==="error"?" arco-upload-list-item-error":""}`)},[d.value&&d.value.url?(s(),c("div",Ve,[i("img",{src:d.value.url},null,8,he),i("div",ye,[e(O)])])):(s(),c("div",Be,[i("div",xe,[e(R)])]))],2)]),_:1},8,["file-list","custom-request"]))]),_:1})]),_:1}),e(b,{title:"\u5C5E\u6027\u4FE1\u606F"},{extra:t(()=>[e(h,{type:"text",onClick:a[7]||(a[7]=l=>u.value.modelProperty.metas.push({name:"",value:""}))},{default:t(()=>[S(" \u6DFB\u52A0 ")]),_:1})]),default:t(()=>[e(z,{gutter:20},{default:t(()=>[(s(!0),c(B,null,x(u.value.modelProperty.metas,(l,K)=>(s(),F($,{key:K,span:6},{default:t(()=>[e(V,null,{default:t(()=>[e(o,{label:"\u5C5E\u6027\u540D"},{default:t(()=>[e(n,{modelValue:l.name,"onUpdate:modelValue":A=>l.name=A},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(o,{label:"\u5C5E\u6027\u503C"},{default:t(()=>[e(n,{modelValue:l.value,"onUpdate:modelValue":A=>l.value=A},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(o,{label:"\u5907\u6CE8"},{default:t(()=>[e(n,{modelValue:u.value.remark,"onUpdate:modelValue":a[8]||(a[8]=l=>u.value.remark=l)},null,8,["modelValue"])]),_:1}),e(o,null,{default:t(()=>[e(h,{"html-type":"submit"},{default:t(()=>[S("\u4FDD\u5B58")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])}}});const Ye=X(we,[["__scopeId","data-v-7292f8ab"]]);export{Ye as default};
