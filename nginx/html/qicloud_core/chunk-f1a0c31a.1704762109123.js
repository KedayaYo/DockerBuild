(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f1a0c31a"],{"0f02":function(e,t,i){},"160b":function(e,t,i){"use strict";const s=[{value:1,label:"入库"},{value:2,label:"在役"},{value:3,label:"故障"},{value:4,label:"报废"}];t["a"]=s},"1d7d":function(e,t,i){"use strict";i("0f02")},"1e1d7":function(e,t,i){},2178:function(e,t,i){},"30da":function(e,t,i){"use strict";i("b770")},"30e6":function(e,t,i){},3272:function(e,t,i){"use strict";t["a"]={DJI_M210V2:{value:"经纬 M210 V2",label:"经纬 M210 V2"},DJI_M300RTK:{value:"经纬 M300 RTK",label:"经纬 M300 RTK"},DJI_M30:{value:"经纬 M30",label:" 经纬 M30"},DJI_Mavic2_hangye:{value:"御 Mavic 2 行业版",label:" 御 Mavic 2 行业版"},DJI_Mavic2_bianjiao:{value:"御Mavic 2变焦版",label:"御Mavic 2变焦版"},DJI_Phantom4Pro:{value:"精灵 Phantom 4 Pro",label:"精灵 Phantom 4 Pro"},DJI_Mavic2_hangyejinjie:{value:"御 2 行业进阶版",label:"御 2 行业进阶版"},DJI_AIR_2S:{value:"DJI AIR 2S",label:"DJI AIR 2S"},DH_X820:{value:"大华 X820",label:"大华 X820"},DH_X1550:{value:"大华 X1550",label:"大华 X1550"},DJI_MAVICE3_E:{value:"DJI_MAVICE3_E",label:"Mavic 3E"},DJI_MAVICE3_T:{value:"DJI_MAVICE3_T",label:"Mavic 3T"}}},"3f74":function(e,t,i){e.exports=i.p+"img/over_icon.4dba895f.png"},"46a1":function(e,t,i){},"4f0f":function(e,t,i){"use strict";i("2178")},"69e4":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"site-list-wrap has-padding"},[t("el-card",[t("el-title",{attrs:{slot:"header"},slot:"header"},[e._v(" 站点列表 ")]),t("el-form",{attrs:{size:"small",model:e.searchForm,inline:!0},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{directives:[{name:"permission",rawName:"v-permission",value:"sitelist/sitelist/add",expression:"'sitelist/sitelist/add'"}],staticClass:"float-right"},[t("el-button",{attrs:{icon:"el-icon-circle-plus-outline",type:"primary"},on:{click:e.handleClickAdd}},[e._v(" 新建 ")])],1),t("el-form-item",{staticClass:"float-right",staticStyle:{"margin-right":"10px"}},[t("el-button",{attrs:{plain:"",type:"primary",icon:"el-icon-tickets"},on:{click:e.handleShowTutorial}},[e._v(" 教程 ")])],1)],1),t("el-table",{attrs:{"text-align":"center",data:e.siteList,"header-cell-style":e.headStyle,"row-class-name":e.tableRowClassName,"cell-style":e.rowStyle,height:"100px"}},[t("template",{slot:"empty"},[t("NoResult",{attrs:{"has-margin":!1}})],1),t("el-table-column",{attrs:{type:"index",label:"序号",width:"60"}}),t("el-table-column",{attrs:{label:"编号",prop:"siteID"}}),t("el-table-column",{attrs:{label:"名称",prop:"siteName"}}),t("el-table-column",{attrs:{label:"地址",prop:"siteAddress","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-link",{attrs:{type:"primary"},on:{click:function(t){e.handleOpenMap(i.row.siteLocation.toString(),"hivemarker",i.row.siteID)}}},[t("i",{staticClass:"el-icon-location"}),e._v(" "+e._s(i.row.siteAddress)+" ")])]}}])}),t("el-table-column",{attrs:{label:"海拔高度",prop:"siteHAltitude",width:"80"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(t.siteHAltitude+"m"||"-")+" ")]}}])}),t("el-table-column",{attrs:{label:"椭球高度",prop:"siteEllipsAltitude",width:"80"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(t.siteEllipsAltitude+"m"||"-")+" ")]}}])}),t("el-table-column",{attrs:{label:"相对地面高度",prop:"siteAltitude",width:"120"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(t.siteAltitude+"m"||"-")+" ")]}}])}),t("el-table-column",{attrs:{label:"起飞高度",prop:"UAVSTAltitude",width:"80"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s((t.UAVSTAltitude||"--")+"m")+" ")]}}])}),t("el-table-column",{attrs:{label:"无人机编号",width:"170"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.UAVInfo&&i.row.UAVInfo.UAVID))])]}}])}),t("el-table-column",{attrs:{label:"机库编号",width:"160"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.hiveinfo&&i.row.hiveinfo.hiveID))])]}}])}),e.isHide("sitelist","sitelist","update")?t("el-table-column",{attrs:{label:"设备配置",width:"160"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"sitelist/sitelist/update",expression:"'sitelist/sitelist/update'"}],staticClass:"sky-tag",attrs:{type:"text",size:"mini"},on:{click:function(t){return e.handleAddEquipment(1,i.row.hiveinfo?i.row.hiveinfo.hiveID:"",i.row.siteID,"hiveID")}}},[t("span",{class:[i.row.hiveinfo&&i.row.hiveinfo.hiveID?"":"no-equipment"]},[e._v("机库")]),t("i",{class:[i.row.hiveinfo&&i.row.hiveinfo.hiveID?"el-icon-edit-outline":"el-icon-circle-plus-outline"]})]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"sitelist/sitelist/update",expression:"'sitelist/sitelist/update'"}],staticClass:"sky-tag",attrs:{type:"text"},on:{click:function(t){return e.handleAddEquipment(2,i.row.UAVInfo?i.row.UAVInfo.UAVID:"",i.row.siteID,"UAVID")}}},[t("span",{class:[i.row.UAVInfo&&i.row.UAVInfo.UAVID?"":"no-equipment"]},[e._v("无人机")]),t("i",{class:[i.row.UAVInfo&&i.row.UAVInfo.UAVID?"el-icon-edit-outline":"el-icon-circle-plus-outline"]})])]}}],null,!1,4179069838)}):e._e(),t("el-table-column",{attrs:{label:"配置模式"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.mate(t.row.siteMode))+" ")]}}])}),t("el-table-column",{attrs:{label:"飞行模式",width:"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tag",{attrs:{size:"mini",type:1===i.row.siteSFMode?"success":"warning"}},[e._v(" "+e._s(1===i.row.siteSFMode?"孤岛模式":"跳棋模式")+" ")])]}}])}),t("el-table-column",{attrs:{label:"创建时间",width:"170"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.createTime)+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"sitelist/sitelist/config",expression:"'sitelist/sitelist/config'"}],attrs:{type:"text"},on:{click:function(t){return e.handleSetMediaServerConfig(i.row)}}},[e._v(" 配置 "),t("i",{staticClass:"el-icon-setting"})]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"sitelist/sitelist/edit",expression:"'sitelist/sitelist/edit'"}],attrs:{type:"text"},on:{click:function(t){return e.handleEdit(i.row)}}},[e._v(" 修改 "),t("i",{staticClass:"el-icon-edit"})]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"sitelist/sitelist/delete",expression:"'sitelist/sitelist/delete'"}],staticStyle:{color:"#eb5300"},attrs:{type:"text"},on:{click:function(t){return e.handleDeleteSite(i.row.siteID)}}},[e._v(" 删除 "),t("i",{staticClass:"el-icon-delete"})]),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleEdit(i.row,!0)}}},[e._v(" 详情 "),t("i",{staticClass:"el-icon-search"})])]}}])})],2),t("el-row",{staticClass:"sorter-wrap"},[t("el-pagination",{staticClass:"x-pagination float-right",attrs:{background:"",layout:"total, prev, pager, next, jumper","current-page":e.tableConfig.page,"page-size":e.tableConfig.size,total:e.tableConfig.total},on:{"current-change":e.handleChangeCPage}})],1)],1),t("el-dialog",{staticClass:"protective-line",attrs:{center:"",visible:e.dialogLineVisible,width:"70%","close-on-click-modal":!1},on:{close:function(t){return e.resetForm("SiteDetailsForm")}}},[t("el-title",{attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.isEdit?e.disabled?"详情":"编辑":"新建")+" ")]),t("el-form",{ref:"SiteDetailsForm",attrs:{size:"small",disabled:e.disabled,"label-position":"right","label-width":"140px",model:e.siteDetails,rules:e.siteRules}},[t("h2",{staticClass:"floor-title"},[e._v(" 基本信息 ")]),t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"站点编号"}},[t("el-input",{attrs:{disabled:e.isEdit},model:{value:e.siteDetails.siteID,callback:function(t){e.$set(e.siteDetails,"siteID",t)},expression:"siteDetails.siteID"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"站点名称",prop:"siteName"}},[t("el-input",{model:{value:e.siteDetails.siteName,callback:function(t){e.$set(e.siteDetails,"siteName",t)},expression:"siteDetails.siteName"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"站点地址",prop:"siteAddress"}},[t("el-input",{model:{value:e.siteDetails.siteAddress,callback:function(t){e.$set(e.siteDetails,"siteAddress",t)},expression:"siteDetails.siteAddress"}})],1)],1)],1),t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"飞行模式",prop:"siteSFMode"}},[t("el-select",{model:{value:e.siteDetails.siteSFMode,callback:function(t){e.$set(e.siteDetails,"siteSFMode",t)},expression:"siteDetails.siteSFMode"}},[t("el-option",{attrs:{value:1,label:"孤岛模式"}}),t("el-option",{attrs:{value:2,label:"跳棋模式"}})],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"地理位置",prop:"siteLocation"}},[t("InputAppend",[t("el-input",{attrs:{placeholder:"121.1234567,31.12345678"},model:{value:e.siteDetails.siteLocation,callback:function(t){e.$set(e.siteDetails,"siteLocation",t)},expression:"siteDetails.siteLocation"}}),t("i",{staticClass:"el-icon-location",attrs:{slot:"input-append"},on:{click:function(t){return e.handleOpenMap(e.siteDetails.siteLocation,e.CLICKMODE.sitemarker,e.siteDetails.siteID)}},slot:"input-append"})],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"配置模式",prop:"siteMode"}},[t("el-select",{model:{value:e.siteDetails.siteMode,callback:function(t){e.$set(e.siteDetails,"siteMode",e._n(t))},expression:"siteDetails.siteMode"}},e._l(e.SITEMODEL,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("el-row",{attrs:{gutter:e.gutter}},[e._e(),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"相对地面高度"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.siteAltitude,callback:function(t){e.$set(e.siteDetails,"siteAltitude",t)},expression:"siteDetails.siteAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v(" m")])],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"无人机起飞高度"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.UAVSTAltitude,callback:function(t){e.$set(e.siteDetails,"UAVSTAltitude",t)},expression:"siteDetails.UAVSTAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v(" m")])],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"海拔高度"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.siteHAltitude,callback:function(t){e.$set(e.siteDetails,"siteHAltitude",t)},expression:"siteDetails.siteHAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v(" m")])],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"椭球高度"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.siteEllipsAltitude,callback:function(t){e.$set(e.siteDetails,"siteEllipsAltitude",t)},expression:"siteDetails.siteEllipsAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v(" m")])],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"上传图片"}},[e.siteDetails.thumbnailBase64?t("el-button",{attrs:{type:"text",icon:"el-icon-picture-outline"},on:{click:function(t){e.imgCropperDialogVisible=!0}}},[e._v(" "+e._s(e.siteDetails.siteName)+" ")]):t("el-button",{on:{click:function(t){e.imgCropperDialogVisible=!0}}},[t("i",{staticClass:"el-icon-upload"}),e._v(" 上传图片 ")])],1)],1)],1),t("h2",{staticClass:"floor-title"},[e._v(" 无人机设置配置 ")]),t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"备降位置类型",prop:"siteOptionMode"}},[t("el-select",{on:{change:e.handleChangeSiteOptionModeType},model:{value:e.siteDetails.siteOptionMode,callback:function(t){e.$set(e.siteDetails,"siteOptionMode",e._n(t))},expression:"siteDetails.siteOptionMode"}},[t("el-option",{attrs:{value:0,label:"手动录入备降点"}}),t("el-option",{attrs:{value:1,label:"不使用备降点"}}),e._e()],1)],1)],1),e.siteDetails.siteOptionMode?e._e():t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"备降位置",prop:"siteOptionLocation"}},[t("InputAppend",[t("el-input",{attrs:{placeholder:"例如：121.1234567,31.12345678"},model:{value:e.siteDetails.siteOptionLocation,callback:function(t){e.$set(e.siteDetails,"siteOptionLocation",t)},expression:"siteDetails.siteOptionLocation"}}),t("i",{staticClass:"el-icon-location",attrs:{slot:"input-append",disabled:""},on:{click:function(t){return e.handleOpenMap(e.siteDetails.siteOptionLocation,e.CLICKMODE.landingmarker,e.siteDetails.siteID)}},slot:"input-append"})],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"备降相对地面高度"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.siteOptionAltitude,callback:function(t){e.$set(e.siteDetails,"siteOptionAltitude",t)},expression:"siteDetails.siteOptionAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v(" m")])],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"备降椭球高度"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.siteOptionEllipsAltitude,callback:function(t){e.$set(e.siteDetails,"siteOptionEllipsAltitude",t)},expression:"siteDetails.siteOptionEllipsAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v(" m")])],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"备降点海拔高度",prop:"siteOptionHAltitude"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.siteOptionHAltitude,callback:function(t){e.$set(e.siteDetails,"siteOptionHAltitude",t)},expression:"siteDetails.siteOptionHAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v("m")])],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"备降点返航高度",prop:"siteOptionRHAltitude","inline-message":""}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{on:{focus:function(t){return e.handleOpenAuxiliaryMessage("备降点返航高度")}},model:{value:e.siteDetails.siteOptionRHAltitude,callback:function(t){e.$set(e.siteDetails,"siteOptionRHAltitude",t)},expression:"siteDetails.siteOptionRHAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v(" m")])],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"返航高度",prop:"siteRHAltitude"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{on:{focus:function(t){return e.handleOpenAuxiliaryMessage("返航高度")}},model:{value:e.siteDetails.siteRHAltitude,callback:function(t){e.$set(e.siteDetails,"siteRHAltitude",t)},expression:"siteDetails.siteRHAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v(" m")])],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"降落朝向",prop:"siteRHHeading"}},[t("el-input",{model:{value:e.siteDetails.siteRHHeading,callback:function(t){e.$set(e.siteDetails,"siteRHHeading",t)},expression:"siteDetails.siteRHHeading"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"降落悬停高度",prop:"siteRHHoverAltitude"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.siteRHHoverAltitude,callback:function(t){e.$set(e.siteDetails,"siteRHHoverAltitude",t)},expression:"siteDetails.siteRHHoverAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v(" m ")])],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"备降朝向"}},[t("el-input",{model:{value:e.siteDetails.siteOptionHeading,callback:function(t){e.$set(e.siteDetails,"siteOptionHeading",t)},expression:"siteDetails.siteOptionHeading"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"备降悬停高度",prop:"siteOptionHoverAltitude"}},[t("InputAppend",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.siteOptionHoverAltitude,callback:function(t){e.$set(e.siteDetails,"siteOptionHoverAltitude",t)},expression:"siteDetails.siteOptionHoverAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v("m")])],1)],1)],1),e._e()],1),t("h2",{staticClass:"floor-title"},[e._v(" 实时视角配置 ")]),t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"实时播流配置"}},[t("el-input",{model:{value:e.siteDetails.videoPullAddr,callback:function(t){e.$set(e.siteDetails,"videoPullAddr",t)},expression:"siteDetails.videoPullAddr"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"实时推流配置"}},[t("el-input",{model:{value:e.siteDetails.videoPushAddr,callback:function(t){e.$set(e.siteDetails,"videoPushAddr",t)},expression:"siteDetails.videoPushAddr"}})],1)],1),e._e()],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.disabled?e._e():t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-success"},on:{click:function(t){return e.submit("SiteDetailsForm")}}},[e._v("确 定")]),t("el-button",{attrs:{plain:"",size:"small",icon:"el-icon-error",type:"primary"},on:{click:function(t){return e.resetForm("SiteDetailsForm")}}},[e._v("取 消")])],1)],1),t("el-dialog",{staticClass:"protective-line",attrs:{center:"",visible:e.equipmentDialogVisible,"before-close":e.handleClose,"destroy-on-close":!0}},[t("el-title",{attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.setDialogTitle)+" ")]),1===e.equipmentt?t("HiveForm",{key:e.dialogElKey+"-hiveForm",ref:e.uRefs[0],attrs:{id:e.uHiveID,equipments:e.hiveList,"component-mode":"site"},on:{handleChangeMode:e.handleChangeMode}}):2===e.equipmentt?t("DroneForm",{key:e.dialogElKey+"-uavForm",ref:e.uRefs[1],attrs:{id:e.uDroneID,"is-edit":e.isEdit,equipments:e.droneList,"component-mode":"site"},on:{handleChangeMode:e.handleChangeMode}}):t("span",{ref:e.uRefs[2]},[e._v("3")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-success"},on:{click:function(t){return e.handleSubmitEquipmentInfo(e.equipmentt)}}},[e._v("确 定")]),t("el-button",{attrs:{plain:"",size:"small",icon:"el-icon-error",type:"primary"},on:{click:function(t){return e.resetEquipmentInfoFrom(e.equipmentt)}}},[e._v("取 消")])],1)],1),t("el-dialog",{staticClass:"protective-night",attrs:{"close-on-click-modal":!1,visible:e.dialogVisible,fullscreen:!0},on:{close:function(t){e.dialogVisible=!1}}},[t("p",{staticClass:"dialog-close-tag"},[t("i",{staticClass:"el-icon-circle-close",on:{click:function(t){e.dialogVisible=!1}}})]),t("flight-tutorial",{on:{goto:e.handleTutorial}})],1),t("el-dialog",{attrs:{visible:e.mapDialog,"destroy-on-close":!0},on:{opened:function(t){return e.initModifyInteraction(e.uCoordinates,e.uMode,e.STID)},close:e.handleCloseOpenLayerMap}},[t("el-title",{attrs:{slot:"title"},slot:"title"},[e._v(" 地图定位 "),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"刷新无人机实时位置",placement:"top"}},[t("i",{staticClass:"el-icon-refresh-right",on:{click:e.handleRefresh}})])],1),t("OlMap",{ref:"OpenLayerMap",attrs:{"map-height":"50vh"},on:{getCoordinates:e.getCoordinates}})],1),t("el-drawer",{staticClass:"cropper-wrap",attrs:{visible:e.imgCropperDialogVisible,"before-close":e.handleCloseImgCropper}},[t("el-title",{attrs:{slot:"title"},slot:"title"},[e._v(" 上传图片 ")]),e.imgCropperDialogVisible?t("ImgCropper",{attrs:{"base-code":e.siteDetails.thumbnailBase64},on:{sendCropperImg:e.handleCropperImg}}):e._e()],1),t("a-modal",{attrs:{centered:"",width:"50%",title:(e.record.siteName?e.record.siteName:"")+" | 媒体服务配置","ok-text":"保存","cancel-text":"关闭","destroy-on-close":!0,visible:e.visible},on:{ok:function(t){return e.submitMediaServerConfig("MediaServerConfigForm")},cancel:e.handleCancel}},[t("el-form",{ref:"MediaServerConfigForm",attrs:{"label-position":"top","label-width":"auto",model:e.mediaServerConfig,rules:e.rules,autocomplete:"off",size:"small"}},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"储存方式",prop:"storageType"}},[t("el-select",{staticStyle:{width:"100%"},on:{change:e.handleChangeStorageType},model:{value:e.mediaServerConfig.storageType,callback:function(t){e.$set(e.mediaServerConfig,"storageType",t)},expression:"mediaServerConfig.storageType"}},[e._l(e.storageTypes,(function(i){return[i.hidden?e._e():t("el-option",{key:i.label,attrs:{value:i.value,label:i.label}})]}))],2)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"文件重命名方式",prop:"mediaRenameType"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.mediaServerConfig.mediaRenameType,callback:function(t){e.$set(e.mediaServerConfig,"mediaRenameType",t)},expression:"mediaServerConfig.mediaRenameType"}},e._l(e.mediaRenameTypes,(function(e){return t("el-option",{key:e.label,attrs:{value:e.value,label:e.label}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"文件储存路径",prop:"storagePathFormat"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.mediaServerConfig.storagePathFormat,callback:function(t){e.$set(e.mediaServerConfig,"storagePathFormat",t)},expression:"mediaServerConfig.storagePathFormat"}},e._l(e.storagePathFormats,(function(e){return t("el-option",{key:e.label,attrs:{value:e.value,label:e.label}})})),1)],1)],1),1===e.mediaServerConfig.storageType||4===e.mediaServerConfig.storageType?[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"桶名称",prop:"storageServerInfo.bucketName"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.bucketName,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"bucketName",t)},expression:"mediaServerConfig.storageServerInfo.bucketName"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"服务器地址",prop:"storageServerInfo.endPoint"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.endPoint,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"endPoint",t)},expression:"mediaServerConfig.storageServerInfo.endPoint"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"密钥ID",prop:"storageServerInfo.accessKeyId"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.accessKeyId,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"accessKeyId",t)},expression:"mediaServerConfig.storageServerInfo.accessKeyId"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"密钥Key",prop:"storageServerInfo.secretAccessKey"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.secretAccessKey,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"secretAccessKey",t)},expression:"mediaServerConfig.storageServerInfo.secretAccessKey"}})],1)],1)]:e._e(),2===e.mediaServerConfig.storageType?[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"ftp服务器地址",prop:"storageServerInfo.ftpAddr"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.ftpAddr,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"ftpAddr",t)},expression:"mediaServerConfig.storageServerInfo.ftpAddr"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"ftp用户名",prop:"storageServerInfo.ftpUsername"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.ftpUsername,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"ftpUsername",t)},expression:"mediaServerConfig.storageServerInfo.ftpUsername"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"ftp密码",prop:"storageServerInfo.ftpPassword"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.ftpPassword,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"ftpPassword",t)},expression:"mediaServerConfig.storageServerInfo.ftpPassword"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.ftpPort"}},[t("label",{attrs:{slot:"label"},slot:"label"},[e._v(" ftp端口 "),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"端口范围0-65535",placement:"top-start"}},[t("i",{staticClass:"el-icon-warning-outline"})])],1),t("el-input",{attrs:{placeholder:"0-65535"},model:{value:e.mediaServerConfig.storageServerInfo.ftpPort,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"ftpPort",e._n("string"===typeof t?t.trim():t))},expression:"mediaServerConfig.storageServerInfo.ftpPort"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.encryption",label:"加密方式"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.mediaServerConfig.storageServerInfo.encryption,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"encryption",t)},expression:"mediaServerConfig.storageServerInfo.encryption"}},e._l(e.encryptions,(function(e){return t("el-option",{key:e.label,attrs:{value:e.value,label:e.label}})})),1)],1)],1)]:e._e(),2===e.mediaServerConfig.storageType?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.protocol",label:"协议"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.mediaServerConfig.storageServerInfo.protocol,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"protocol",t)},expression:"mediaServerConfig.storageServerInfo.protocol"}},[t("el-option",{attrs:{value:"FTP",label:"FTP"}}),t("el-option",{attrs:{value:"SFTP",label:"SFTP"}})],1)],1)],1):e._e(),3===e.mediaServerConfig.storageType?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.protocol",label:" 协议"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.mediaServerConfig.storageServerInfo.protocol,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"protocol",t)},expression:"mediaServerConfig.storageServerInfo.protocol"}},[t("el-option",{attrs:{value:"HTTP",label:"HTTP"}}),t("el-option",{attrs:{value:"HTTPS",label:"HTTPS"}})],1)],1)],1):e._e(),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.character",label:"编码字符集"}},[t("el-input",{attrs:{placeholder:"UTF-8"},model:{value:e.mediaServerConfig.storageServerInfo.character,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"character",t)},expression:"mediaServerConfig.storageServerInfo.character"}})],1)],1),3===e.mediaServerConfig.storageType?[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.token",label:"Token"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.token,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"token",t)},expression:"mediaServerConfig.storageServerInfo.token"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.uploadUrl",label:"http上传路径"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.uploadUrl,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"uploadUrl",t)},expression:"mediaServerConfig.storageServerInfo.uploadUrl"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.requestMethod",label:"请求方式"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.requestMethod,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"requestMethod",t)},expression:"mediaServerConfig.storageServerInfo.requestMethod"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.contentType",label:"数据传输方式"}},[t("el-input",{attrs:{placeholder:"multipart/form-data"},model:{value:e.mediaServerConfig.storageServerInfo.contentType,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"contentType",t)},expression:"mediaServerConfig.storageServerInfo.contentType"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.dataType",label:"数据类型"}},[t("el-input",{attrs:{placeholder:"MultipartRequest"},model:{value:e.mediaServerConfig.storageServerInfo.dataType,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"dataType",t)},expression:"mediaServerConfig.storageServerInfo.dataType"}})],1)],1)]:e._e(),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"上传完成回调地址",prop:"callBackUrl"}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入上传回调地址"},model:{value:e.mediaServerConfig.callBackUrl,callback:function(t){e.$set(e.mediaServerConfig,"callBackUrl",t)},expression:"mediaServerConfig.callBackUrl"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.baseUrl",label:"上传基地址"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.baseUrl,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"baseUrl",t)},expression:"mediaServerConfig.storageServerInfo.baseUrl"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"三方平台上传完成回调地址",prop:"callBackUrl"}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入上传回调地址"},model:{value:e.mediaServerConfig.mediaOtherConfig.callbackUrl,callback:function(t){e.$set(e.mediaServerConfig.mediaOtherConfig,"callbackUrl",t)},expression:"mediaServerConfig.mediaOtherConfig.callbackUrl"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"三方平台Token",prop:"callBackUrl"}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入Token"},model:{value:e.mediaServerConfig.mediaOtherConfig.callbackToken,callback:function(t){e.$set(e.mediaServerConfig.mediaOtherConfig,"callbackToken",t)},expression:"mediaServerConfig.mediaOtherConfig.callbackToken"}})],1)],1)],2)],1)],1)],1)},r=[],o=(i("46a1"),i("450d"),i("e5f2")),a=i.n(o),l=(i("d9e2"),i("13d5"),i("14d9"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"tutorial-wrapper"},e._l(e.process,(function(i,s){return t("process-item",{key:s,attrs:{"img-src":i.src,title:i.title,content:i.content}},[e.isHide(i.permission)?t("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return e.$emit("goto",i.key)}}},[e._v(" "+e._s(i.btnVal)+" ")]):e._e()],1)})),1)}),n=[],d=function(){var e=this,t=e._self._c;return t("div",{staticClass:"process-item"},[t("el-image",{attrs:{src:e.imgSrc}}),t("strong",[e._v(e._s(e.title))]),t("p",{staticClass:"process-content"},[e._v(" "+e._s(e.content)+" ")]),e._t("default")],2)},c=[],u={name:"PItem",props:{imgSrc:{type:String,default:""},title:{type:String,default:""},content:{type:String,default:""},btnVal:{type:String,default:"未知"}},data(){return{}},created(){}},p=u,f=(i("1d7d"),i("2877")),m=Object(f["a"])(p,d,c,!1,null,null,null),g=m.exports,h=i("742b"),v=i.n(h),b=i("bf90"),I=i.n(b),S=i("3f74"),C=i.n(S),y=i("e350"),D={name:"Tutorial",components:{ProcessItem:g},data(){return{process:[{src:v.a,title:"新建站点",content:"第一步：新建一个站点",btnVal:"立刻去",key:"dialogLineVisible",permission:"sitelist/sitelist/add"},{src:I.a,title:"新建设备",content:"第二步：添加每一个设备，请注意，每个设备都需要单独添加哦！",btnVal:"立刻去",key:"equipmentDialogVisible",permission:"sitelist/sitelist/update"},{src:C.a,title:"完成",content:"操作完以上两步，就可以使用啦！",btnVal:"完成",key:"dialogVisible"}]}},methods:{handleTutorialItem(e){this.$emit("handleTutorialItem",e)},isHide(e){if(e){const[t,i,s]=e.split("/");return Object(y["b"])(t,i,s)}return!0}}},k=D,A=(i("e36b"),Object(f["a"])(k,l,n,!1,null,"58f26c96",null)),_=A.exports,w=i("da01"),T=i("c691"),O=i("22e6"),$=i("16d5"),M=i("a670"),x=i("514b"),E=i("61f7");const V=[{value:1,label:"机库＋射频箱"},{value:2,label:"射频箱"},{value:6,label:"机库＋4G"},{value:7,label:"机库＋5G"}];var H=V,L=i("fea2"),U=i("07fd"),q=i("29b2"),F=i("ed08");let P=null;const N=[{value:0,label:"暂无配置"},{value:1,hidden:U["j"],label:"oss"},{value:2,label:"ftp"},{value:3,label:"http"},{value:4,label:"minio"}],R=[{value:0,label:"不重命名"},{value:1,label:"根据航点序号重命名"},{value:2,label:"根据航点名称重命名"}],j=[{value:0,label:"原路径"},{value:1,label:"增加镜头类型子目录"}],K=[{value:"show",label:"显式加密"},{value:"implicit",label:"隐式加密"},{value:"clear",label:"明文"}];var B={name:"SiteList",components:{FlightTutorial:_,HiveForm:w["a"],DroneForm:T["a"],OlMap:O["a"],ImgCropper:M["a"],NoResult:$["a"]},props:{role:{type:String,default:""}},data(){const e=(e,t,i)=>{if(!t)return i("服务地址不能为空");const s=/^((ht|f)tps?:\/\/)?[\w-]+(\.[\w-]+)+:\d{1,5}\/?$/;s.test(t)&&i(),i(new Error("地址错误"))},t=(e,t,i)=>{if(!t)return i();const[s,r]=t.split(","),o=/^[-+]?(0(\.\d{1,10})?|([1-9](\d)?)(\.\d{1,10})?|1[0-7]\d{1}(\.\d{1,10})?|180\.0{1,10})$/,a=/^[-+]?((0|([1-8]\d?))(\.\d{1,10})?|90(\.0{1,10})?)$/;return o.test(s)&&a.test(r)?(i(),!0):(i(new Error("坐标例:121.3245671,31.123456")),!1)};return{disabled:!1,gutter:10,pId:"",cpId:"",uSTID:"",uCoordinates:"",uMode:"",STID:"",uDroneID:"",uHiveID:"",dialogElKey:"",equipmentt:1,visible:!1,record:{},isEdit:!1,dialogLineVisible:!1,dialogVisible:!1,equipmentDialogVisible:!1,mapDialog:!1,imgCropperDialogVisible:!1,storageTypes:N,mediaRenameTypes:R,storagePathFormats:j,encryptions:K,siteList:[],hiveList:[],droneList:[],SITEMODEL:H,CLICKMODE:U["b"],uRefs:["HiveInfoForm","DroneInfoForm","ComputedInfoForm"],siteMode:[1,2,6,7],socketInstance:null,droneMessage:null,hiveInformation:{},droneInformation:{},tableConfig:{page:1,size:20,total:0,isSiteType:1},searchForm:{corporation:"",project:""},siteDetails:{siteID:"",siteName:"",siteAddress:"",siteLocation:"",siteMode:"",siteSFMode:"",thumbnailBase64:"",siteAltitude:"",UAVSTAltitude:"",siteHAltitude:"",siteEllipsAltitude:"",siteOptionMode:0,siteOptionLocation:"",siteRHAltitude:"",siteOptionRHAltitude:"",siteRHHeading:"",siteRHHoverAltitude:"",siteOptionAltitude:"",siteOptionHAltitude:"",siteOptionHeading:"",siteOptionEllipsAltitude:"",siteOptionHoverAltitude:"",videoPullAddr:"",videoPushAddr:""},mediaServerConfig:{storageType:"",mediaRenameType:"",storagePathFormat:"",storageServerInfo:{bucketName:"",endPoint:"",accessKeyId:"",secretAccessKey:"",ftpPort:"",ftpPassword:"",ftpAddr:"",ftpUsername:"",protocol:"",encryption:"",character:"UTF-8",baseUrl:"/",uploadUrl:"",token:"",requestMethod:"",contentType:"",dataType:""},mediaOtherConfig:{callbackUrl:"",callbackToken:""},callBackUrl:""},rules:{storageType:[{required:!0,message:"请选择储存方式",trigger:"change"}],mediaRenameType:[{required:!0,message:"请选择储存方式",trigger:"blur"}],storagePathFormat:[{required:!0,message:"请选择储存方式",trigger:"change"}],"storageServerInfo.bucketName":[{required:!0,message:"请输入容器名称",trigger:"blur"}],"storageServerInfo.endPoint":[{required:!0,validator:e,trigger:"blur"}],"storageServerInfo.accessKeyId":[{required:!0,message:"请输入密钥ID",trigger:"blur"}],"storageServerInfo.secretAccessKey":[{required:!0,message:"请输入密钥key",trigger:"blur"}],"storageServerInfo.ftpAddr":[{required:!0,message:"请输入ftp服务器地址",trigger:"blur"}],"storageServerInfo.ftpPassword":[{required:!0,message:"请输入ftp服务器地址",trigger:"blur"}],"storageServerInfo.ftpPort":[{required:!0,message:"请输入ftp服务器地址",trigger:"blur"}],"storageServerInfo.ftpUsername":[{required:!0,message:"请输入ftp服务器地址",trigger:"blur"}],"storageServerInfo.baseUrl":[{required:!1,message:"请输入ftp服务器地址",trigger:"blur"}],"storageServerInfo.protocol":[{required:!0,message:"请输入协议类型",trigger:"blur"}],"storageServerInfo.encryption":[{required:!0,message:"请输入加密方式",trigger:"blur"}],"storageServerInfo.character":[{required:!0,message:"请输入字符集",trigger:"blur"}],"storageServerInfo.uploadUrl":[{required:!0,message:"请输入上传路径",trigger:"blur"}],"storageServerInfo.token":[{required:!0,message:"请输入鉴权密钥（token）",trigger:"blur"}],"storageServerInfo.requestMethod":[{required:!0,message:"请输入请求方法",trigger:"blur"}],"storageServerInfo.contentType":[{required:!0,message:"请输入传输方式",trigger:"blur"}],"storageServerInfo.dataType":[{required:!0,message:"请输入数据类型",trigger:"blur"}],"mediaOtherConfig.callbackUrl":[{required:!1,message:"请输入数据类型",trigger:"blur"}],"mediaOtherConfig.callbackToken":[{required:!1,message:"请输入数据类型",trigger:"blur"}]},siteRules:{siteID:[{required:!0,validator:E["j"],trigger:"blur"}],siteName:[{required:!0,validator:E["k"],trigger:"blur"}],siteAddress:[{required:!0,message:"请输入站点位置",trigger:"blur"}],siteLocation:[{required:!0,validator:E["f"],trigger:"blur"}],siteMode:[{required:!0,message:"请选择站点模式",trigger:"change"}],siteSFMode:[{required:!0,message:"请选择类型",trigger:"change"}],siteOptionMode:[{required:!0,message:"请选择备降位置类型",trigger:"change"}],siteOptionLocation:[{required:!0,validator:t,trigger:"blur"}],siteAltitude:[{required:!0,validator:E["e"],trigger:"blur"}],UAVSTAltitude:[{required:!0,validator:E["e"],trigger:"blur"}],siteHAltitude:[{required:!0,validator:E["e"],trigger:"blur"}],siteEllipsAltitude:[{required:!0,validator:E["e"],trigger:"blur"}],siteRHAltitude:[{required:!0,validator:E["e"],trigger:"blur"}],siteOptionRHAltitude:[{required:!0,validator:E["e"],trigger:"blur"}],siteRHHeading:[{required:!0,validator:E["e"],trigger:"blur"}],siteRHHoverAltitude:[{required:!0,validator:E["c"],trigger:"blur"}],siteOptionAltitude:[{required:!0,validator:E["e"],trigger:"blur"}],siteOptionHAltitude:[{required:!0,validator:E["e"],trigger:"blur"}],siteOptionEllipsAltitude:[{required:!0,validator:E["e"],trigger:"blur"}]},numberKey:{siteAltitude:"",UAVSTAltitude:"",siteHAltitude:"",siteEllipsAltitude:"",siteRHAltitude:"",siteOptionRHAltitude:"",siteRHHeading:"",siteRHHoverAltitude:"",siteOptionHeading:"",siteOptionAltitude:"",siteOptionHAltitude:"",siteOptionEllipsAltitude:"",siteOptionHoverAltitude:""},bkgSiteDetails:{}}},computed:{setDialogTitle(){return`${this.isEdit?"绑定":"新建"}${1===this.equipmentt?"机库":"无人机"}`},hasRole(){return"admin"===this.role}},watch:{equipmentDialogVisible(){this.dialogElKey=Math.random()},"mediaServerConfig.storageType":function(e,t){this.onChangeStorageTypeMediaServerConfigValidate_1_4(1===e||4===e),this.onChangeStorageTypeMediaServerConfigValidate_2(2===e),this.onChangeStorageTypeMediaServerConfigValidate_3(3===e)}},created(){this.getSiteList(this.tableConfig),this.getHiveList(),this.getDroneList(),this.socketConnect()},beforeDestroy(){a.a.closeAll(),P=null},methods:{handleOpenAuxiliaryMessage(e){P&&P.close(),P=a.a.warning({title:e,message:"请根据现场环境设置高度值",duration:0,showClose:!1})},isHide(e,t,i){return Object(y["b"])(e,t,i)},headStyle(){return"text-align:center;background:#F4F7FD"},rowStyle(){return"text-align:center"},tableRowClassName({rowIndex:e}){return e%2===0?"even-number":"uneven-number"},handleChangeCPage(e){this.tableConfig.page=e,this.getSiteList(this.tableConfig)},handleTutorial(e){this[e]=!0,this.dialogVisible=!1},setEditModel(e){this.isEdit=e},handleChangeMode(e){this.isEdit=!e},handleClickAdd(){this.dialogLineVisible=!0},mate(e){const[{label:t}]=this.SITEMODEL.filter(t=>e===t.value);return t},async handleAddEquipment(e,t,i){if(this.uSTID=i,this.equipmentt=e,!t)return this[1===e?"uHiveID":"uDroneID"]=t,this.isEdit=!0,void(this.equipmentDialogVisible=!0);const s=1===e?await this.$store.dispatch("hive/getHiveDetails",{hiveID:t}):await this.$store.dispatch("uav/getDroneDetails",{UAVID:t});this.$confirm("请选择操作方式","提示",{confirmButtonText:"编辑",cancelButtonText:"解绑设备",distinguishCancelAndClose:!0,type:"warning"}).then(()=>{this.isEdit=!0,t?this[1===e?"uHiveID":"uDroneID"]=t:(this.isEdit=!1,this[1===e?"uHiveID":"uDroneID"]=""),this.equipmentt=e,this.equipmentDialogVisible=!0}).catch(async t=>{if("cancel"===t){const t=this.formatSubmitInformation(s.data,"",!0,1===e?"HIVEINFO_TEMPLATE":"UAVINFO_TEMPLATE"),{code:i,reason:r}=1===e?await this.$store.dispatch("hive/updateHiveDetails",t):await this.$store.dispatch("uav/editDroneDetails",t);if(!Object(x["a"])(i))return this.$message.error("设备解绑失败"+r);this.getSiteList(this.tableConfig),this.$message({type:"info",message:"设备已解绑"})}return""})},handleClose(){this.$confirm("确认关闭？").then(()=>{this.resetEquipmentInfoFrom(this.equipmentt)}).catch(()=>{})},handleOpenMap(e,t,i){if(!this.siteRules.siteOptionLocation[0].required)return this.$message.warning("当备降位置类型为“手动录入备降点”此功能才可开启");this.uCoordinates=e,this.uMode=t,this.STID=i,this.mapDialog=!0},handleRefresh(){this.initModifyInteraction(this.uCoordinates,this.uMode,this.STID)},initModifyInteraction(e,t,i){"hivemarker"!==t&&this.$refs.OpenLayerMap.setupMapClick(t),this.$refs.OpenLayerMap.setCoordinatestoMap(e.split(","),t),new Promise(e=>{this.socketInstance.on(i+" state",t=>{1===t.type&&e(t)})}).then(e=>{this.socketInstance.removeEventListener(i+" state"),this.droneMessage=e;const{latitudeWGS:t,longitudeWGS:s}=this.droneMessage;0!==t&&0!==s&&this.$refs.OpenLayerMap.setCoordinatestoMap([s,t],"dronemarker")})},getCoordinates(e){this.uCoordinates=e.lnglat.map(e=>e.toFixed(7)).join(","),this.siteDetails[e.key]=JSON.parse(JSON.stringify(e.lnglat)).map(e=>e.toFixed(7)).join(",")},handleCloseOpenLayerMap(){this.mapDialog=!1},handleCloseImgCropper(){this.imgCropperDialogVisible=!1},handleCropperImg(e){const{close:t,base64:i}=e;this.siteDetails.thumbnailBase64=i,t&&this.handleCloseImgCropper()},handleShowTutorial(){this.dialogVisible=!0},async handleSetMediaServerConfig(e){var t,i,s,r;this.record=e;const o=await this.$store.dispatch("site/fetchMediaConfig",{id:e.siteID}),a={1:"ossConfig",2:"ftpConfig",3:"httpConfig",4:"minio"},{code:l,data:n,reason:d}=o;if(!Object(x["a"])(l))return;this.mediaServerConfig.storageType=n.storageType,this.mediaServerConfig.callBackUrl=n.callBackUrl,this.mediaServerConfig.mediaRenameType=null===n||void 0===n||null===(t=n.mediaOtherConfig)||void 0===t?void 0:t.mediaRenameType,this.mediaServerConfig.storagePathFormat=null===n||void 0===n||null===(i=n.mediaOtherConfig)||void 0===i?void 0:i.storagePathFormat,this.mediaServerConfig.mediaOtherConfig.callbackUrl=(null===n||void 0===n||null===(s=n.mediaOtherConfig)||void 0===s?void 0:s.callbackUrl)||"",this.mediaServerConfig.mediaOtherConfig.callbackToken=(null===n||void 0===n||null===(r=n.mediaOtherConfig)||void 0===r?void 0:r.callbackToken)||"";const c={...this.mediaServerConfig.storageServerInfo,...n[a[this.mediaServerConfig.storageType]]};this.mediaServerConfig.storageServerInfo=c,this.visible=!0},submitMediaServerConfig(e){this.$refs[e].validate(async e=>{if(e){const e=await this.$store.dispatch("site/updateMediaConfig",{siteID:this.record.siteID,...this.mediaServerConfig});if(!Object(x["a"])(e.code))return;this.$message.success(e.reason),this.initMidelConfigForm("MediaServerConfigForm")}})},handleCancel(){this.initMidelConfigForm("MediaServerConfigForm")},initMidelConfigForm(e){this.$refs[e].resetFields(),this.visible=!1},async handleEdit(e,t){var i;this.disabled=t;const{code:s,data:r,reason:o}=await this.$store.dispatch("site/getSiteDetail",{siteID:e.siteID});if(!Object(x["a"])(s))return this.$message.error("站点详情获取失败："+o);this.uDroneID=null===(i=r.UAVInfo)||void 0===i?void 0:i.UAVID,this.isEdit=!0;const a=this.$deepClone(r);return Object.keys(this.siteDetails).forEach(e=>{Array.isArray(a[e])&&0!==a[e].length?this.siteDetails[e]=a[e].join(","):this.siteDetails[e]=a[e]}),this.siteRules.siteOptionLocation[0].required=Boolean(0===this.siteDetails.siteOptionMode),this.bkgSiteDetails=this.$deepClone(this.siteDetails),this.dialogLineVisible=!0,""},handleDeleteSite(e){this.$confirm("此操作将该站点, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const{code:t,reason:i}=await this.$store.dispatch("site/deleteSite",{siteID:e});return Object(x["a"])(t)?(this.$message({type:"success",message:"删除成功!"}),this.getSiteList(this.tableConfig),""):this.$message.error("删除失败："+i)}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},cascaderValueChange(e){e.length>0?1===e.length?this.pId=e[0]:(this.cpId=e[0],this.pId=e[1]):this.pId="",this.$emit("pId",this.pId)},handleSubmitEquipmentInfo(e){if("number"!==typeof e||!e)throw new Error("请传入正确的设备类型");this.$refs[this.uRefs[e-1]].submit().then(async t=>{const i=this.formatSubmitInformation(t,this.uSTID,this.isEdit,1===e?"HIVEINFO_TEMPLATE":"UAVINFO_TEMPLATE"),s=this.isEdit?await this.$store.dispatch(1===e?"hive/updateHiveDetails":"uav/editDroneDetails",i):await this.$store.dispatch(1===e?"hive/addHiveInfo":"uav/addDroneInfo",i);return Object(x["a"])(s.code)?(this.$message.success("成功"),this.getSiteList(this.tableConfig),this.resetEquipmentInfoFrom(e),""):this.$message.error(""+s.reason)}).catch(()=>{this.$message.error(`请正确完善${1===e?"机库":"无人机"}信息`)})},formatSubmitInformation(e,t,i,s="HIVEINFO_TEMPLATE"){const r={};return Object.keys(L["a"][s]).forEach(t=>{r[t]=e[t]}),r.siteID=t,i&&(r[1===this.equipmentt?"newHiveID":"newUAVID"]=r[1===this.equipmentt?"hiveID":"UAVID"]),r},appendKey(){},submit(e){this.$refs[e].validate(async t=>{if(t){const t=this.$deepClone(this.siteDetails),{siteLocation:i,siteOptionLocation:s}=this.siteDetails;t.siteLocation=i?i.split(",").map(Number):[],t.siteOptionLocation=s?s.split(",").map(Number):"",Object.keys(this.numberKey).forEach(e=>{t[e]&&(t[e]=parseFloat(t[e]))}),Object.keys(t).forEach(e=>{t[e]||delete t[e]}),t.siteOptionMode=this.siteDetails.siteOptionMode;const{code:r,reason:o}=this.isEdit?await this.$store.dispatch("site/updateSiteDetails",t):await this.$store.dispatch("site/appendSite",t),a=Object(x["a"])(r);if(this.$message[a?"success":"error"](`${this.isEdit?"修改":"新建"}站点信息 ${a?"成功":"失败"}：${o}`),!a)throw new Error("error");this.getSiteList(this.tableConfig),this.resetForm(e)}return!1})},resetForm(e){this.uDroneID="",this.dialogLineVisible=!1,this.isEdit=!1,this.disabled=!1,this.$refs[e].resetFields(),Object.keys(this.siteDetails).forEach(e=>{this.siteDetails[e]="","siteOptionMode"===e&&(this.siteDetails[e]=0)}),this.bkgSiteDetails={},a.a.closeAll()},resetEquipmentInfoFrom(e){this.equipmentDialogVisible=!1,this.$refs[this.uRefs[e-1]].resetForm()},async getSiteList({page:e,size:t,PID:i="",siteIDs:s="",isSiteType:r=1}){const{code:o,data:a,reason:l}=await this.$store.dispatch("site/getSiteList",{page:e,size:t,PID:i,isSiteType:r,siteIDs:s});if(!Object(x["a"])(o))return this.$message.error("请求失败："+l);const{list:n,total:d}=a;this.siteList=n.reduce((e,t)=>(this.siteMode.includes(t.siteMode)&&e.push(t),e),[]),this.tableConfig.total=void 0===d?this.tableConfig.total:d||0},async getHiveList(){const{code:e,data:t,reason:i}=await this.$store.dispatch("hive/getHiveList",{page:1,size:500});if(!Object(x["a"])(e))return this.$message.error("获取机库列表失败："+i);const{list:s}=t;return this.hiveList=s,s},async getDroneList(){const{code:e,data:t,reason:i}=await this.$store.dispatch("uav/getDroneList",{page:1,size:500});if(!Object(x["a"])(e))return this.$message.error("获取无人机列表失败："+i);const{list:s}=t;return this.droneList=s,s},async fetchMediaConfig(e){var t;const i=await this.$store.dispatch("site/fetchMediaConfig",{id:e});var s;if(null!==(t=i.data)&&void 0!==t&&t.ftpConfig)return null===(s=i.data)||void 0===s?void 0:s.ftpConfig},socketConnect(){const e=Object(F["a"])("socketIOConfig");this.socketInstance=q["a"].initSocket(e)},onChangeStorageTypeMediaServerConfigValidate_1_4(e){this.rules["storageServerInfo.bucketName"][0].required=e,this.rules["storageServerInfo.endPoint"][0].required=e,this.rules["storageServerInfo.accessKeyId"][0].required=e,this.rules["storageServerInfo.secretAccessKey"][0].required=e},onChangeStorageTypeMediaServerConfigValidate_2(e){this.rules["storageServerInfo.ftpAddr"][0].required=e,this.rules["storageServerInfo.ftpPassword"][0].required=e,this.rules["storageServerInfo.ftpPort"][0].required=e,this.rules["storageServerInfo.ftpUsername"][0].required=e,this.rules["storageServerInfo.protocol"][0].required=e,this.rules["storageServerInfo.encryption"][0].required=e,this.rules["storageServerInfo.character"][0].required=e},onChangeStorageTypeMediaServerConfigValidate_3(e){this.rules["storageServerInfo.protocol"][0].required=e,this.rules["storageServerInfo.uploadUrl"][0].required=e,this.rules["storageServerInfo.token"][0].required=e},handleChangeStorageType(e){this.mediaServerConfig={storageType:e,mediaRenameType:0,storagePathFormat:0,storageServerInfo:{bucketName:"",endPoint:"",accessKeyId:"",secretAccessKey:"",ftpPort:"",ftpPassword:"",ftpAddr:"",ftpUsername:"",protocol:"",encryption:"",character:"UTF-8",baseUrl:"/",uploadUrl:"",token:"",requestMethod:"",contentType:"",dataType:""},mediaOtherConfig:{callbackUrl:"",callbackToken:""},callBackUrl:""}},handleChangeSiteOptionModeType(e){this.siteDetails.siteOptionLocation=0===e?this.bkgSiteDetails.siteOptionLocation:"",this.siteRules.siteOptionLocation[0].required=Boolean(0===e)}}},z=B,J=(i("4f0f"),Object(f["a"])(z,s,r,!1,null,"2101101e",null));t["default"]=J.exports},"742b":function(e,t,i){e.exports=i.p+"img/start_icon.c4b79808.png"},b770:function(e,t,i){},bf90:function(e,t,i){e.exports=i.p+"img/midway_icon.e3aa84e4.png"},c691:function(e,t,i){"use strict";var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"drone-infor-form-wrap"},[t("el-form",{ref:"droneInformationForm",attrs:{size:"small","label-position":"right","label-width":"110px",model:e.droneInformation,rules:e.rules,disabled:e.disabled}},[t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"无人机编号",prop:"UAVID"}},[e.equipments.length?t("InputAppend",{attrs:{type:"icon"}},[e.isAdd?t("el-input",{attrs:{disabled:e.isEdit},model:{value:e.droneInformation.UAVID,callback:function(t){e.$set(e.droneInformation,"UAVID",t)},expression:"droneInformation.UAVID"}}):t("el-select",{on:{change:e.handleChange},model:{value:e.droneInformation.UAVID,callback:function(t){e.$set(e.droneInformation,"UAVID",t)},expression:"droneInformation.UAVID"}},e._l(e.equipments,(function(e){return t("el-option",{key:e.UAVID,attrs:{value:e.UAVID,label:e.UAVID}})})),1),t("span",{attrs:{slot:"input-append"},on:{click:e.handleChangeMode},slot:"input-append"},[t("i",{staticClass:"el-icon-refresh"})])],1):t("el-input",{attrs:{disabled:e.isEdit},model:{value:e.droneInformation.UAVID,callback:function(t){e.$set(e.droneInformation,"UAVID",t)},expression:"droneInformation.UAVID"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"无人机名称",prop:"UAVName"}},[t("el-input",{model:{value:e.droneInformation.UAVName,callback:function(t){e.$set(e.droneInformation,"UAVName",t)},expression:"droneInformation.UAVName"}})],1)],1)],1),t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"机身号SN",prop:"SN"}},[t("el-input",{model:{value:e.droneInformation.SN,callback:function(t){e.$set(e.droneInformation,"SN",t)},expression:"droneInformation.SN"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"序列号FCSN",prop:"FCSN"}},[t("el-input",{model:{value:e.droneInformation.FCSN,callback:function(t){e.$set(e.droneInformation,"FCSN",t)},expression:"droneInformation.FCSN"}})],1)],1)],1),t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"无人机型号",prop:"model"}},[t("el-select",{model:{value:e.droneInformation.model,callback:function(t){e.$set(e.droneInformation,"model",t)},expression:"droneInformation.model"}},e._l(e.models,(function(e,i){return t("el-option",{key:i,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"边缘计算机",prop:"isHaveComputer"}},[t("el-select",{model:{value:e.droneInformation.isHaveComputer,callback:function(t){e.$set(e.droneInformation,"isHaveComputer",t)},expression:"droneInformation.isHaveComputer"}},[t("el-option",{attrs:{label:"有",value:1}}),t("el-option",{attrs:{label:"无",value:2}})],1)],1)],1)],1),t("el-form-item",{attrs:{label:"FLV视频流"}},[t("el-input",{model:{value:e.droneInformation.UAVFLVURL,callback:function(t){e.$set(e.droneInformation,"UAVFLVURL",t)},expression:"droneInformation.UAVFLVURL"}})],1),"site"===e.componentMode?t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"边缘计算机1"}},[t("InputAppend",{attrs:{type:"text"}},[t("el-select",{model:{value:e.droneInformation.ECID1,callback:function(t){e.$set(e.droneInformation,"ECID1",t)},expression:"droneInformation.ECID1"}},e._l(e.computerList,(function(e){return t("el-option",{key:e.ECID,attrs:{value:e.ECID,label:e.ECID}})})),1),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[t("el-tooltip",{attrs:{content:"遥控器关联的安卓设备",placement:"top",effect:"light"}},[t("i",{staticClass:"el-icon-question"})])],1)],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"边缘计算机2"}},[t("InputAppend",{attrs:{type:"text"}},[t("el-select",{model:{value:e.droneInformation.ECID2,callback:function(t){e.$set(e.droneInformation,"ECID2",t)},expression:"droneInformation.ECID2"}},e._l(e.computerList,(function(e){return t("el-option",{key:e.ECID,attrs:{value:e.ECID,label:e.ECID}})})),1),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[t("el-tooltip",{attrs:{content:"无人机机载端关联的机载电脑",placement:"top",effect:"light"}},[t("i",{staticClass:"el-icon-question"})])],1)],1)],1)],1)],1):e._e()],1)],1)},r=[],o=(i("d9e2"),i("61f7")),a=i("3272"),l=i("160b"),n=i("514b"),d={name:"DroneInfoForm",props:{gutter:{type:Number,default:10},disabled:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},data:{type:Object,default(){return{}}},equipments:{type:Array,default(){return[]}},siteList:{type:Array,default(){return[]}},id:{type:String,default:""},componentMode:{type:String,default:""},dialogVisible:{type:Boolean,default:!1}},data(){return{isAdd:!1,computerList:[],models:[],UAVMODELS:a["a"],deviceStatus:l["a"],droneInformation:{UAVID:"",UAVName:"",model:"",configMode:"",isHaveComputer:2,FCSN:"",SN:"",siteID:"",ECID1:"",ECID2:"",content:"",UAVFLVURL:""},rules:{UAVID:[{validator:o["d"],trigger:"blur"}],UAVName:[{required:!0,message:"请输入无人机名称",trigger:"blur"},{min:1,max:16,message:"长度在16个字符以下",trigger:"blur"}],SN:[{required:!0,validator:o["i"],trigger:"blur"}],FCSN:[{required:!0,validator:o["i"],trigger:"blur"}],siteID:[{required:!0,message:"请选择站点",trigger:"blur"}],model:[{required:!0,message:"请选择无人机型号",trigger:"blur"}],isHaveComputer:[{required:!0,message:"请选择边缘计算机配置",trigger:"blur"}]}}},created(){if(this.fetch(),this.data){const e=this.$deepClone(this.data);Object.keys(this.droneInformation).forEach(t=>{void 0===this.droneInformation[t]&&delete e[t]}),this.droneInformation=e}this.id&&this.$store.dispatch("uav/getDroneDetails",{UAVID:this.id}).then(e=>{const{data:t}=e;this.droneInformation=t}),this.dialogVisible&&this.getComputerList()},methods:{submit(e="droneInformationForm"){return new Promise((t,i)=>{this.$refs[e].validate(e=>{e?t(this.droneInformation):i(new Error("信息不全"))})})},resetForm(e="droneInformationForm"){this.$refs[e].resetFields(),this.droneInformation={}},handleChangeMode(){this.isAdd=!this.isAdd,this.droneInformation={},this.$emit("handleChangeMode",this.isAdd)},async handleChange(e){const{data:t}=await this.$store.dispatch("uav/getDroneDetails",{UAVID:e});this.droneInformation=t},async getComputerList(e=1,t=500,i=""){const{code:s,data:r,reason:o}=await this.$store.dispatch("computer/getComputerList",{page:e,size:t,ECID:i});if(!Object(n["a"])(s))return this.$message("请求失败："+o);const{list:a}=r;return this.computerList=a,a},async fetch(){try{const e=await this.$store.dispatch("device/fetch",{modelType:1});this.models=null===e||void 0===e?void 0:e.data.map(e=>({value:e.modelCode,label:e.modelName}))}catch(e){console.error(e),this.$message.error("请求无人机模型失败，请联系管理员")}}}},c=d,u=(i("f5ac"),i("2877")),p=Object(u["a"])(c,s,r,!1,null,"2db70a7b",null);t["a"]=p.exports},da01:function(e,t,i){"use strict";var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"hive-infor-form-wrap"},[t("el-form",{ref:"hiveInformationForm",attrs:{size:"small","label-position":"right","label-width":"80px",model:e.hiveInfo,rules:e.rules,disabled:e.disabled}},[t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"机库编号",prop:"hiveID"}},[Boolean(e.equipments.length)?t("InputAppend",[!e.isAdd&&Boolean(e.equipments.length)?t("el-select",{on:{change:function(t){return e.handleChange(e.hiveInfo.hiveID)}},model:{value:e.hiveInfo.hiveID,callback:function(t){e.$set(e.hiveInfo,"hiveID",t)},expression:"hiveInfo.hiveID"}},e._l(e.equipments,(function(e){return t("el-option",{key:e.hiveID,attrs:{label:e.hiveID,value:e.hiveID}})})),1):t("el-input",{attrs:{disabled:e.isEdit},model:{value:e.hiveInfo.hiveID,callback:function(t){e.$set(e.hiveInfo,"hiveID","string"===typeof t?t.trim():t)},expression:"hiveInfo.hiveID"}}),t("i",{staticClass:"el-icon-refresh",attrs:{slot:"input-append"},on:{click:e.handleChangeMode},slot:"input-append"})],1):t("el-input",{attrs:{disabled:e.isEdit},model:{value:e.hiveInfo.hiveID,callback:function(t){e.$set(e.hiveInfo,"hiveID","string"===typeof t?t.trim():t)},expression:"hiveInfo.hiveID"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"机库名称",prop:"hiveName"}},[t("el-input",{model:{value:e.hiveInfo.hiveName,callback:function(t){e.$set(e.hiveInfo,"hiveName","string"===typeof t?t.trim():t)},expression:"hiveInfo.hiveName"}})],1)],1)],1),t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"机库类型",prop:"hiveType"}},[t("el-radio",{attrs:{label:1},model:{value:e.hiveInfo.hiveType,callback:function(t){e.$set(e.hiveInfo,"hiveType",t)},expression:"hiveInfo.hiveType"}},[e._v(" 固定 ")]),t("el-radio",{attrs:{label:2},model:{value:e.hiveInfo.hiveType,callback:function(t){e.$set(e.hiveInfo,"hiveType",t)},expression:"hiveInfo.hiveType"}},[e._v(" 移动 ")])],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"机库型号",prop:"hiveModel"}},[t("el-select",{model:{value:e.hiveInfo.hiveModel,callback:function(t){e.$set(e.hiveInfo,"hiveModel",t)},expression:"hiveInfo.hiveModel"}},e._l(e.models,(function(e,i){return t("el-option",{key:i,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("el-form-item",{attrs:{label:"FLV流地址"}},[t("el-input",{model:{value:e.hiveInfo.hiveFLVURL,callback:function(t){e.$set(e.hiveInfo,"hiveFLVURL",t)},expression:"hiveInfo.hiveFLVURL"}})],1),t("el-form-item",{attrs:{label:"机库描述"}},[t("el-input",{attrs:{type:"textarea",maxlength:"200","show-word-limit":""},model:{value:e.hiveInfo.context,callback:function(t){e.$set(e.hiveInfo,"context",t)},expression:"hiveInfo.context"}})],1)],1)],1)},r=[],o=(i("d9e2"),i("14d9"),i("b7c3")),a=i("160b"),l=i("61f7"),n=i("514b"),d={name:"HiveInfoForm",props:{gutter:{type:Number,default:10},disabled:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},data:{type:Object,default(){return{}}},equipments:{type:Array,default(){return[]}},id:{type:String,default(){return""}}},data(){return{isAdd:!1,deviceStatus:a["a"],siteList:[],hiveModeList:[],hiveInfo:{hiveID:"",hiveName:"",hiveType:1,hiveModel:"",siteID:"",context:"",hiveFLVURL:""},rules:{hiveID:[{validator:l["b"],trigger:"blur"}],hiveName:[{required:!0,message:"请输入机库名称",trigger:"blur"}],hiveType:[{required:!0,message:"请选择机库类型",trigger:"change"}],hiveModel:[{required:!0,message:"请选择机库型号",trigger:"change"}],siteID:[{required:!0,message:"请选择站点",trigger:"blur"}]},models:[]}},created(){if(this.id&&this.getHiveDetails(this.id),this.data){const e=this.$deepClone(this.data);Object.keys(e).forEach(t=>{void 0===this.hiveInfo[t]&&delete e[t]}),this.hiveInfo=e}this.getHiveOptions(),this.has&&this.getSiteGroup(),this.fetch()},methods:{handleChangeMode(){this.isAdd=!this.isAdd,this.hiveInfo={},this.$emit("handleChangeMode",this.isAdd)},submit(e="hiveInformationForm"){return new Promise((t,i)=>{this.$refs[e].validate(e=>{e?t(this.hiveInfo):i(new Error("信息不全"))})})},resetForm(e="hiveInformationForm"){this.$refs[e].resetFields()},handleChange(e){this.getHiveDetails(e)},getHiveOptions(){const e=o["f"].HIVEMODEL.getAllKeys();e.forEach(e=>{this.hiveModeList.push({value:e,label:o["f"].HIVEMODEL.getDescFromValue(e)})})},async getSiteGroup(){const{code:e,data:t,reason:i}=await this.$store.dispatch("site/getSiteGroup");if(!Object(n["a"])(e))return this.$message.error("请求失败："+i);const{list:s}=t;return this.siteList=s,s},async getHiveDetails(e){const{code:t,data:i}=await this.$store.dispatch("hive/getHiveDetails",{hiveID:e});return Object(n["a"])(t)?(this.hiveInfo=i,i):this.$message.error("获取机库信息失败")},async fetch(){try{const e=await this.$store.dispatch("device/fetch",{modelType:2});this.models=e.data.map(e=>({value:e.modelCode,label:e.modelName}))}catch(e){console.error(e),this.$message.error("请求机库模型失败，请联系管理员")}}}},c=d,u=(i("30da"),i("2877")),p=Object(u["a"])(c,s,r,!1,null,"35d4985e",null);t["a"]=p.exports},e36b:function(e,t,i){"use strict";i("1e1d7")},e5f2:function(e,t,i){e.exports=function(e){var t={};function i(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(s,r,function(t){return e[t]}.bind(null,r));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/",i(i.s=80)}({0:function(e,t,i){"use strict";function s(e,t,i,s,r,o,a,l){var n,d="function"===typeof e?e.options:e;if(t&&(d.render=t,d.staticRenderFns=i,d._compiled=!0),s&&(d.functional=!0),o&&(d._scopeId="data-v-"+o),a?(n=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},d._ssrRegister=n):r&&(n=l?function(){r.call(this,this.$root.$options.shadowRoot)}:r),n)if(d.functional){d._injectStyles=n;var c=d.render;d.render=function(e,t){return n.call(t),c(e,t)}}else{var u=d.beforeCreate;d.beforeCreate=u?[].concat(u,n):[n]}return{exports:e,options:d}}i.d(t,"a",(function(){return s}))},13:function(e,t){e.exports=i("5128")},23:function(e,t){e.exports=i("41f8")},7:function(e,t){e.exports=i("2b0e")},80:function(e,t,i){"use strict";i.r(t);var s=i(7),r=i.n(s),o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"el-notification-fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],class:["el-notification",e.customClass,e.horizontalClass],style:e.positionStyle,attrs:{role:"alert"},on:{mouseenter:function(t){e.clearTimer()},mouseleave:function(t){e.startTimer()},click:e.click}},[e.type||e.iconClass?i("i",{staticClass:"el-notification__icon",class:[e.typeClass,e.iconClass]}):e._e(),i("div",{staticClass:"el-notification__group",class:{"is-with-icon":e.typeClass||e.iconClass}},[i("h2",{staticClass:"el-notification__title",domProps:{textContent:e._s(e.title)}}),i("div",{directives:[{name:"show",rawName:"v-show",value:e.message,expression:"message"}],staticClass:"el-notification__content"},[e._t("default",[e.dangerouslyUseHTMLString?i("p",{domProps:{innerHTML:e._s(e.message)}}):i("p",[e._v(e._s(e.message))])])],2),e.showClose?i("div",{staticClass:"el-notification__closeBtn el-icon-close",on:{click:function(t){return t.stopPropagation(),e.close(t)}}}):e._e()])])])},a=[];o._withStripped=!0;var l={success:"success",info:"info",warning:"warning",error:"error"},n={data:function(){return{visible:!1,title:"",message:"",duration:4500,type:"",showClose:!0,customClass:"",iconClass:"",onClose:null,onClick:null,closed:!1,verticalOffset:0,timer:null,dangerouslyUseHTMLString:!1,position:"top-right"}},computed:{typeClass:function(){return this.type&&l[this.type]?"el-icon-"+l[this.type]:""},horizontalClass:function(){return this.position.indexOf("right")>-1?"right":"left"},verticalProperty:function(){return/^top-/.test(this.position)?"top":"bottom"},positionStyle:function(){var e;return e={},e[this.verticalProperty]=this.verticalOffset+"px",e}},watch:{closed:function(e){e&&(this.visible=!1,this.$el.addEventListener("transitionend",this.destroyElement))}},methods:{destroyElement:function(){this.$el.removeEventListener("transitionend",this.destroyElement),this.$destroy(!0),this.$el.parentNode.removeChild(this.$el)},click:function(){"function"===typeof this.onClick&&this.onClick()},close:function(){this.closed=!0,"function"===typeof this.onClose&&this.onClose()},clearTimer:function(){clearTimeout(this.timer)},startTimer:function(){var e=this;this.duration>0&&(this.timer=setTimeout((function(){e.closed||e.close()}),this.duration))},keydown:function(e){46===e.keyCode||8===e.keyCode?this.clearTimer():27===e.keyCode?this.closed||this.close():this.startTimer()}},mounted:function(){var e=this;this.duration>0&&(this.timer=setTimeout((function(){e.closed||e.close()}),this.duration)),document.addEventListener("keydown",this.keydown)},beforeDestroy:function(){document.removeEventListener("keydown",this.keydown)}},d=n,c=i(0),u=Object(c["a"])(d,o,a,!1,null,null,null);u.options.__file="packages/notification/src/main.vue";var p=u.exports,f=i(9),m=i.n(f),g=i(13),h=i(23),v=r.a.extend(p),b=void 0,I=[],S=1,C=function e(t){if(!r.a.prototype.$isServer){t=m()({},t);var i=t.onClose,s="notification_"+S++,o=t.position||"top-right";t.onClose=function(){e.close(s,i)},b=new v({data:t}),Object(h["isVNode"])(t.message)&&(b.$slots.default=[t.message],t.message="REPLACED_BY_VNODE"),b.id=s,b.$mount(),document.body.appendChild(b.$el),b.visible=!0,b.dom=b.$el,b.dom.style.zIndex=g["PopupManager"].nextZIndex();var a=t.offset||0;return I.filter((function(e){return e.position===o})).forEach((function(e){a+=e.$el.offsetHeight+16})),a+=16,b.verticalOffset=a,I.push(b),b}};["success","warning","info","error"].forEach((function(e){C[e]=function(t){return("string"===typeof t||Object(h["isVNode"])(t))&&(t={message:t}),t.type=e,C(t)}})),C.close=function(e,t){var i=-1,s=I.length,r=I.filter((function(t,s){return t.id===e&&(i=s,!0)}))[0];if(r&&("function"===typeof t&&t(r),I.splice(i,1),!(s<=1)))for(var o=r.position,a=r.dom.offsetHeight,l=i;l<s-1;l++)I[l].position===o&&(I[l].dom.style[r.verticalProperty]=parseInt(I[l].dom.style[r.verticalProperty],10)-a-16+"px")},C.closeAll=function(){for(var e=I.length-1;e>=0;e--)I[e].close()};var y=C;t["default"]=y},9:function(e,t){e.exports=i("7f4d")}})},f5ac:function(e,t,i){"use strict";i("30e6")},fea2:function(e,t,i){"use strict";const s={hiveID:"",hiveName:"",hiveType:1,hiveModel:"",siteID:"",context:"",hiveFLVURL:""},r={UAVID:"",UAVName:"",brand:"",model:"",configMode:"",FCSN:"",SN:"",ECID1:"",ECID2:"",siteID:"",content:"",UAVFLVURL:"",isHaveComputer:2};t["a"]={HIVEINFO_TEMPLATE:s,UAVINFO_TEMPLATE:r}}}]);
//# sourceMappingURL=chunk-f1a0c31a.1704762109123.js.map