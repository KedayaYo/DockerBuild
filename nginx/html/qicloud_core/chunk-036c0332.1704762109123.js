(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-036c0332"],{"0d57":function(e,t,i){"use strict";i("e127")},"21d7":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAtFJREFUWEfFlVuITWEUx/9rjm99zUwat5pEFKVcmhpyKZc8SPLAoLwqyYuUopiaQjJu5VKeSORNkYkHD6KUy4NbmkzUpFAeFA9kOt9ae1radY6OsffZ++ScM/tt9/3X+v9a31rrI4zzR+Phb2bToyjaHUXR1aYDqGqvmR0G8NM5N6NpACMjIzMLhcIVIlpfqvoFZt7XFIAQwkIiegZgYvnKzeyk97634QAisgLAIwBc2W9mdtR7f6ShACGELiJ6k9ToDQcws6mq+g7AtJRJa2wPiMgQgPlpY25m97z3GxtyBSJyDsC+jB0z4pybXHcAEdkF4HKeBUdEG+oKUCwW57a0tAznMS9pntcVQETeAlhQA8CTugGoap+ZHctpPmxmfd77G3UBMLMpqvotjzkR7XfOnS1rqwLEr5aqHjSzS977eKwSP1W9bWY9GQAfAGxn5peVulQAEdkL4Hi8v4nornNuU5KBqq40s8cZ5oPOuWVEVByr+wdARJYDOA1gTaVYVWe0t7d/GZtARN4DmFcF4Jlzbi0RSZLmD4CZdapqP4CdiUKiO865zZVnIYRtRHSzivkLZl5arTpULBbnFAqFHjM7UvlcpgQtYeZX5TMR+QhgVop2qFT2X1UBVPWAmZ3J08EAHjPz6lgrInsAXEyJ++Gc60y688QeEJFuIorneGsWSBRFs9ra2j6LyHcAk1P0i5n5dVau+PyvJlTVVWZ2HsCSKsHXzGyAiAZSemWdc+5BHvN/AMpBIYQTRHQob5KyLo5xzp2qJS51D4QQthDRrbFVqpL8OjPvqMU8tQIVXd4N4CGASRmJvzJzZ63mmQCxoLSO7wNYmGZgZl3e+8GGAJQgWFWfA+hKMNnLzGnjmMmU+zU0swmqGo/WooqsT5l5ZaZLFUFugFIlOlQ13n4d8f/o6Ojs1tbWT00DiI1CCIuIKJ7zfma+8D/muZrwfw2y4n8DbHMV27AIIEQAAAAASUVORK5CYII="},"271a":function(e,t,i){"use strict";var a=i("cb2d"),s=i("e330"),n=i("577e"),o=i("d6d6"),l=URLSearchParams,c=l.prototype,r=s(c.getAll),d=s(c.has),h=new l("a=1");!h.has("a",2)&&h.has("a",void 0)||a(c,"has",(function(e){var t=arguments.length,i=t<2?void 0:arguments[1];if(t&&void 0===i)return d(this,e);var a=r(this,e);o(t,1);var s=n(i),l=0;while(l<a.length)if(a[l++]===s)return!0;return!1}),{enumerable:!0,unsafe:!0})},"3b67":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAeVJREFUSEvtl0+ITlEYxn+PKUWa0kg2ysqfbCzszU6iFGPBYtCMFUJhiQVJNghFTMwUmxkLqTEbsZaF8mcvSynJQuHRub2fbl9xz7m+hsV3627ufd/nd99znvt0r/hHh9pwbS8G5oDVwG5JT0p12oLXA68CNilp73yB1wFvAnZF0pH5Aq8F3gbskqRjfXDTCrQ1V3+p++Zq8hb/v7lsL5P0IY1iux6ZlyUdjeuLgIWSPjWNnDWx7QfAFuCspHO2VwLvQvyapEO21wBPgSXAsKQXf4Lngl0TGZE0Y/sbMACMS7pt+yOwNOr2SbrbC/BW4FFN6DowAiwHEmAVsCnu3wNGJX3/a3Ds3w5gpib2A1jQJT4haaxpf9P9rKXuCNneDDz+jXC11znQYnBMvhOY7gJMSRrNhVZg22eAW5Le5zbaPgDcjPppSbsKetMrdzyBk2PvS9qT2xyTbwOGmtzbrRmDnu6An0kaLgG3rbU9AezvgD9LGmwrVtJn+zmwsQNOvYclXS0RKa2tvxUJ/DXla4hskPSyVDCnPmU98DpCp3J1+ia+E80pFE4As0C2yxvACZhS7TywImovVgFi+wJwMufJe1DzUNL2X8ll+2DAh4D0i1KUag0P9AVI5w1Jp1olVw8mriR+AmoL0gwoUQDQAAAAAElFTkSuQmCC"},"4e05":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("el-card",[t("div",{staticClass:"container-header",attrs:{slot:"header"},slot:"header"},[t("div",{staticClass:"mission-title"},[t("PointTitle",{attrs:{name:"成果展示"}}),e.missionName?t("div",{staticClass:"mission-info"},[e._v(" "+e._s(e.missionName)+" ")]):e._e()],1)]),t("div",{staticClass:"func-area"},[t("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{type:"flex"}},[t("el-col",[t("el-select",{staticStyle:{"margin-right":"12px"},attrs:{size:"mini"},on:{change:function(t){return e.search(!0)}},model:{value:e.mediaType,callback:function(t){e.mediaType=t},expression:"mediaType"}},[t("el-option",{attrs:{label:"全部",value:0}}),t("el-option",{attrs:{label:"照片",value:"photo"}}),t("el-option",{attrs:{label:"视频",value:"video"}})],1),t("el-select",{attrs:{size:"mini"},on:{change:function(t){return e.search(!0)}},model:{value:e.mediaViewType,callback:function(t){e.mediaViewType=t},expression:"mediaViewType"}},[t("el-option",{attrs:{label:"全部类型",value:0}}),t("el-option",{attrs:{label:"红外",value:"THRM"}}),t("el-option",{attrs:{label:"广角",value:"WIDE"}}),t("el-option",{attrs:{label:"变焦",value:"ZOOM"}})],1)],1),t("el-col",{staticStyle:{"text-align":"right"},attrs:{justify:"space-between"}},[e.isDownload?e._e():t("el-checkbox",{staticStyle:{"margin-right":"19px"},on:{change:e.handleCheckedAllSource},model:{value:e.allSource,callback:function(t){e.allSource=t},expression:"allSource"}},[e._v(" 全选 ")]),t("el-button",{attrs:{size:"mini",type:e.isDownload?"primary":""},on:{click:e.handleChangeViewType}},[e.isDownload?t("img",{staticStyle:{width:"12px"},attrs:{src:i("3b67"),alt:""}}):e._e(),e._v(" "+e._s(e.isDownload?"批量下载":"取消")+" ")]),e.isDownload?e._e():t("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:[e.downloadCheckedSource],expression:"[downloadCheckedSource]"}],attrs:{size:"mini",type:"primary",disabled:e.isDownload}},[t("img",{staticStyle:{width:"12px"},attrs:{src:i("3b67"),alt:""}}),e._v(" 下载 ")])],1)],1)],1),t("div",{staticClass:"container-inner x-scroll-white"},[t("div",{staticClass:"list"},[e.mediaList.length>0?t("a-row",e._l(e.mediaList,(function(a,s){return t("a-col",{key:s},[t("div",{class:["module",e.isDownload?"":"view-download ",a.checked?"stroke":""],on:{click:function(t){return t.stopPropagation(),e.goToView(a,s)}}},[t("div",{class:["triangle",a.checked?"active":""],on:{click:function(e){e.stopPropagation(),a.checked=!a.checked}}},[t("img",{staticClass:"el-target",attrs:{src:i("21d7")}})]),a.fileShowThumbnail?t("div",{staticClass:"thumbnail"},[t("img",{attrs:{src:a.fileShowThumbnail}})]):e._e(),t("div",{staticClass:"module-content"},[t("div",{staticClass:"name-line"},[t("el-tooltip",{attrs:{content:a.fileName,placement:"bottom",effect:"dark"}},[t("div",{staticClass:"task-name"},[e._v(" "+e._s(a.fileName)+" ")])])],1),t("div",{staticClass:"time-line"},[t("span",{staticClass:"time"},[e._v(e._s(e.$moment(a.mediaShootTime).format("YYYY-MM-DD HH:mm")))])])])])])})),1):t("NoResult")],1),e.isEnd&&e.mediaList.length>0&&e.pagination.page>1?t("div",{staticClass:"no-result"},[t("span",{staticClass:"line"}),t("span",{staticClass:"txt"},[e._v("没有更多结果")]),t("span",{staticClass:"line"})]):e._e()])])],1)},s=[],n=(i("88a7"),i("271a"),i("5494"),i("2f62")),o=i("16d5"),l=i("f121");let c=null;var r={components:{NoResult:o["a"]},data(){return{mediaType:0,mediaViewType:0,siteID:null,missionBatch:null,isEnd:!1,allSource:!1,loading:!1,downloading:!1,viewType:"show",pagination:{page:1,size:20,total:0},mediaList:[],viewMediaList:[],viewDialog:!1,initialIndex:null,missionName:""}},computed:{checkedCount(){return this.mediaList.filter(e=>Boolean(e.checked)).length},isDownload(){return"show"===this.viewType}},watch:{checkedCount(e,t){this.mediaList.length!==e?this.allSource=!1:this.allSource=!0}},created(){this.siteID=this.$route.query.siteID,this.missionBatch=this.$route.query.missionBatch},async mounted(){this.getMissionInfo(),c=document.getElementsByClassName("container")[0],c.addEventListener("scroll",this.getScrollMore),this.search(!0)},beforeDestroy(){c.removeEventListener("scroll",this.getScrollMore),c=null},methods:{...Object(n["b"])({getMediaList:"flight/getMediaList",getBatchinfo:"flight/getBatchinfo",downloadMediaFileZip:"media/downloadMediaFileZip",getMediaDetails:"media/getMediaDetails"}),getScrollMore(){const e=document.getElementsByClassName("container")[0],{scrollTop:t}=c,i=(document.documentElement.clientHeight||document.body.clientHeight)-document.getElementsByClassName("header")[0].clientHeight,{scrollHeight:a}=e;t+i>=a&&this.search(!1)},async search(e){if(e&&(this.isEnd=!1,this.pagination={page:1,size:20,total:0}),this.isEnd)return;const t={stId:this.siteID,missionBatch:this.missionBatch,mediaType:this.mediaType||void 0,mediaViewType:this.mediaViewType||void 0};this.getMediaList(t).then(t=>{const i=t.map(e=>{var t;return Object.assign(e,{isMp4:null===(t=e.filePreview)||void 0===t?void 0:t.toLowerCase().includes(".mp4"),checked:!1,missionBatch:this.missionBatch})});e?(document.getElementsByClassName("container")[0].scrollTo(0,0),this.mediaList=i||[]):this.mediaList=[...this.mediaList,...i]||!1,this.mediaList.length>=t.length&&(this.isEnd=!0)})},handleCheckedAllSource(e){this.mediaList.forEach(t=>{t.checked=e})},handleChangeViewType(){"show"===this.viewType?this.viewType="download":(this.mediaList.forEach(e=>{e.checked=!1}),this.viewType="show")},async getMissionInfo(){const{missionName:e=""}=await this.getBatchinfo({missionBatch:this.missionBatch});this.missionName=e||""},async goToView(e,t){this.$preview.confirm({title:"提醒",content:"要删除吗？一旦删除将不可恢复",record:e,mediaList:this.mediaList,index:t,onOK:()=>{},onCancel:()=>{},onNext:()=>{console.log("Next")}})},async downloadCheckedSource(){const e=this.mediaList.filter(({checked:e})=>Boolean(e));if(e.length){const t=l["api"].Media,i=`${t}/OssMediaManage/downloadMediaFileZip?mediaNameList=${e.map(({fileName:e})=>e).join(",")}&siteID=${this.siteID}&missionBatch=${this.missionBatch}`,a=document.createElement("a");a.style.display="none",a.href=i,a.download=this.missionBatch+".zip",a.click(),URL.revokeObjectURL(a.href)}else this.$message.warning("请选择需要下载的数据")}}},d=r,h=(i("0d57"),i("9e00"),i("2877")),m=Object(h["a"])(d,a,s,!1,null,"0255de46",null);t["default"]=m.exports},5494:function(e,t,i){"use strict";var a=i("83ab"),s=i("e330"),n=i("edd0"),o=URLSearchParams.prototype,l=s(o.forEach);a&&!("size"in o)&&n(o,"size",{get:function(){var e=0;return l(this,(function(){e++})),e},configurable:!0,enumerable:!0})},"88a7":function(e,t,i){"use strict";var a=i("cb2d"),s=i("e330"),n=i("577e"),o=i("d6d6"),l=URLSearchParams,c=l.prototype,r=s(c.append),d=s(c["delete"]),h=s(c.forEach),m=s([].push),u=new l("a=1&a=2&b=3");u["delete"]("a",1),u["delete"]("b",void 0),u+""!=="a=2"&&a(c,"delete",(function(e){var t=arguments.length,i=t<2?void 0:arguments[1];if(t&&void 0===i)return d(this,e);var a=[];h(this,(function(e,t){m(a,{key:t,value:e})})),o(t,1);var s,l=n(e),c=n(i),u=0,p=0,g=!1,A=a.length;while(u<A)s=a[u++],g||s.key===l?(g=!0,d(this,s.key)):p++;while(p<A)s=a[p++],s.key===l&&s.value===c||r(this,s.key,s.value)}),{enumerable:!0,unsafe:!0})},"9e00":function(e,t,i){"use strict";i("e7c1")},d6d6:function(e,t,i){"use strict";var a=TypeError;e.exports=function(e,t){if(e<t)throw new a("Not enough arguments");return e}},e127:function(e,t,i){},e7c1:function(e,t,i){},edd0:function(e,t,i){"use strict";var a=i("13d2"),s=i("9bf2");e.exports=function(e,t,i){return i.get&&a(i.get,t,{getter:!0}),i.set&&a(i.set,t,{setter:!0}),s.f(e,t,i)}}}]);
//# sourceMappingURL=chunk-036c0332.1704762109123.js.map