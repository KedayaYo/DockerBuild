(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-73c9b612","chunk-a19d65b0"],{"02b6":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{staticClass:"full-screen-dialog",staticStyle:{margin:"0"},attrs:{"append-to-body":"",title:"",width:"100%",visible:e.dialog},on:{"update:visible":function(t){e.dialog=t}}},[r("div",{staticClass:"schedule"},[r("div",[r("div",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.title))]),r("div",[r("el-button",[e._v("向上")]),r("el-button",[e._v("向下")]),r("el-button",[e._v("单次")]),r("el-button",[e._v("每天")]),r("el-button",[e._v("每周")]),r("el-button",[e._v("每月")])],1),r("span")]),r("div",{staticClass:"table-container"},[r("table",[r("thead",[r("tr",[r("th",{staticClass:"div-title-first"}),e._l(e.dates,(function(t,o){return r("th",{key:o,staticClass:"div-title-top"},[e._v(e._s(t))])}))],2)]),r("tbody",e._l(e.shifts,(function(t,o){return r("tr",{key:o},[r("th",{staticClass:"div-title-content"},[e._v(e._s(t))]),e._l(e.dates,(function(o){return r("td",{key:o},[r("div",{staticClass:"shift-slot",on:{click:function(r){return e.selectSlot(t,o)}}})])}))],2)})),0)])]),r("task-dialog",{ref:"taskDialog"})],1)])},i=[],s=(r("99af"),r("14d9"),r("c740"),r("a434"),r("b0c0"),r("8391")),n={components:{taskDialog:s["default"]},data:function(){return{dialog:!1,siteID:"",siteName:"",weekStartingDate:new Date("2022-01-01"),showShiftForm:!1,schedules:[],selectedSlot:null,showModal:!1,schedule:{name:"",start:"",end:""},daysInMonth:[],shifts:["00:00","00:30","01:00","01:30","02:00","02:30","03:00","03:30","04:00","04:30","05:00","05:30","06:00","06:30","07:00","07:30","08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30"]}},computed:{dates:function(){for(var e=new Date,t=e.getFullYear(),r=e.getMonth(),o=[],i=e.getDate();i<=e.getDate()+6;i+=1){var s=new Date(t,r,i),n=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"][s.getDay()],a="".concat(n," ").concat(t,"-").concat(r+1,"-").concat(i);o.push(a)}return o}},mounted:function(){},methods:{show:function(e,t){this.siteID=e,this.siteName=t,this.dialog=!0},getTimeToString:function(e,t){var r=e.getFullYear(),o=e.getMonth(),i=e.getDate(),s=t.getHours(),n=t.getMinutes(),a=t.getSeconds();return o>=1&&o<=9&&(o="0"+o),i>=0&&i<=9&&(i="0"+i),s>=0&&s<=9&&(s="0"+s),n>=0&&n<=9&&(n="0"+n),a>=0&&a<=9&&(a="0"+a),r+"-"+o+"-"+i+" "+s+":"+n+":"+a},getDateTime:function(e){var t=e,r=t.split(" "),o=r[0].split("-"),i=r[1].split(":"),s=new Date(o[0],o[1]-1,o[2],i[0],i[1],i[2]);return s},selectSlot:function(e,t){var r=t.split(" ")[1];console.log(this.getDateTime(r+" "+e+":00"),new Date);var o=this.getDateTime(r+" "+e+":00").getTime(),i=(new Date).getTime();if(console.log("shitDate",o,i),o<i)this.$modal.msgError("请选择正确的时间");else{console.log(e,t),this.selectedSlot={shift:e,date:t};var s=this.$refs.taskDialog;s.show(this.siteID,this.siteName),s.initParam(e,r),console.log(this.showModal)}},saveSchedule:function(){var e=this.selectedSlot,t=e.shift,r=e.date,o=this.schedules.findIndex((function(e){return e.shift===t&&e.date.getTime()===r.getTime()}));if(-1!==o){var i=this.schedules[o];Object.assign(i,this.schedule),this.schedules.splice(o,1,i)}else this.schedules.push({shiftId:shiftId,date:r,name:this.schedule.name,start:this.schedule.start,end:this.schedule.end});this.schedule={name:"",start:"",end:""},this.showModal=!1}}},a=n,u=(r("0d59"),r("2877")),c=Object(u["a"])(a,o,i,!1,null,"6e498f5d",null);t["default"]=c.exports},"0d59":function(e,t,r){"use strict";r("3f08")},"3f08":function(e,t,r){},"511f1":function(e,t,r){"use strict";r("b1e1")},5575:function(e,t,r){"use strict";r.d(t,"n",(function(){return s})),r.d(t,"h",(function(){return n})),r.d(t,"z",(function(){return a})),r.d(t,"a",(function(){return u})),r.d(t,"C",(function(){return c})),r.d(t,"E",(function(){return l})),r.d(t,"B",(function(){return m})),r.d(t,"j",(function(){return f})),r.d(t,"w",(function(){return d})),r.d(t,"k",(function(){return h})),r.d(t,"y",(function(){return b})),r.d(t,"t",(function(){return g})),r.d(t,"i",(function(){return p})),r.d(t,"F",(function(){return v})),r.d(t,"u",(function(){return k})),r.d(t,"r",(function(){return T})),r.d(t,"v",(function(){return D})),r.d(t,"q",(function(){return O})),r.d(t,"p",(function(){return j})),r.d(t,"f",(function(){return w})),r.d(t,"c",(function(){return _})),r.d(t,"d",(function(){return y})),r.d(t,"g",(function(){return x})),r.d(t,"e",(function(){return I})),r.d(t,"x",(function(){return A})),r.d(t,"s",(function(){return S})),r.d(t,"b",(function(){return N})),r.d(t,"o",(function(){return $})),r.d(t,"A",(function(){return C})),r.d(t,"D",(function(){return W}));var o=r("b775"),i=r("c38a");r("bc3a");function s(e){return Object(o["a"])({url:"/fcs/sites/"+Object(i["g"])(e),method:"get"})}function n(e){return Object(o["a"])({url:"/fcs/control/uavs/cancel_fly_point",method:"post",data:e})}function a(e){return Object(o["a"])({url:"/fcs/sites/page",method:"get",params:e})}function u(e){return Object(o["a"])({url:"/fcs/sites",method:"post",data:e})}function c(e,t,r){return Object(o["a"])({url:"/fcs/sites/bindHive/"+Object(i["g"])(e)+"/"+Object(i["g"])(t)+"/"+Object(i["g"])(r),method:"PATCH",data:{}})}function l(e,t,r){return Object(o["a"])({url:"/fcs/sites/bindUav/"+Object(i["g"])(e)+"/"+Object(i["g"])(t)+"/"+Object(i["g"])(r),method:"PATCH",data:{}})}function m(e){return Object(o["a"])({url:"/fcs/sites/"+Object(i["g"])(e.siteId),method:"PUT",data:e})}function f(e){return Object(o["a"])({url:"/fcs/sites/"+Object(i["g"])(e),method:"delete"})}function d(e){return Object(o["a"])({url:"/fcs/missions",method:"get",params:e})}function h(e){return Object(o["a"])({url:"/fcs/missions/"+Object(i["g"])(e)+"/"+Object(i["g"])("-1"),method:"PATCH"})}function b(e){return Object(o["a"])({url:"/fcs/missions",method:"post",data:e})}function g(e){return Object(o["a"])({url:"/fcs/missions/"+Object(i["g"])(e),method:"get"})}function p(e){return Object(o["a"])({url:"/fcs/cronmissions/cd/list",method:"get",params:e})}function v(e){return Object(o["a"])({url:"/fcs/cronmissions/validlist",method:"get",params:e})}function k(e,t){return Object(o["a"])({url:e,method:"post",data:t})}function T(e){return Object(o["a"])({url:"/fcs/uavaction/mediasetting",method:"post",params:e})}function D(e){return Object(o["a"])({url:"/fcs/control/uavs/fly_point",method:"post",data:e})}function O(e){return Object(o["a"])({url:"/fcs/uavaction/locationsetting",method:"post",params:e})}function j(e){return Object(o["a"])({url:"/fcs/uavaction/gimbalsetting",method:"post",params:e})}function w(e){return Object(o["a"])({url:"/fcs/control/uavs/camera_set_zoom",method:"post",data:e})}function _(e){return Object(o["a"])({url:"/fcs/control/uavs/camera_aim",method:"post",data:e})}function y(e){return Object(o["a"])({url:"/fcs/control/uavs/camera_mode_switch",method:"post",data:e})}function x(e){return Object(o["a"])({url:"/fcs/control/uavs/camera_take_photo",method:"post",data:e})}function I(e){return Object(o["a"])({url:"/fcs/control/uavs/camera_recording",method:"post",data:e})}function A(e){return Object(o["a"])({url:"/fcs/rcsetting",method:"post",params:e})}function S(e){return Object(o["a"])({url:"/fcs/control/uav_missions/perform_task",method:"post",data:e})}function N(e){return Object(o["a"])({url:"/fcs/task_manage/uav_task/task_progress/"+Object(i["g"])(e),method:"get"})}function $(e){return Object(o["a"])({url:"/fcs/task_manage/uav_task/task_log_info/"+Object(i["g"])(e),method:"get"})}function C(e){return Object(o["a"])({url:"/fcs/control/uavs/uav_manual",method:"post",data:e})}function W(e,t){return Object(o["a"])({url:"/fcs/task_manage/uav_task/ir_dect_results/update_status/"+Object(i["g"])(e)+"/"+Object(i["g"])(t),method:"PATCH"})}},8391:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{staticStyle:{height:"400px","margin-top":"200px",overflow:"hidden"},attrs:{title:"计划任务",visible:e.visible,width:"550px","append-to-body":"","close-on-click-modal":!1,"before-close":e.cancelAction},on:{"update:visible":function(t){e.visible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,size:"small",rules:e.rules,"label-position":"left","label-width":"100px"}},[r("el-form-item",{attrs:{label:"计划任务",prop:"missionID"}},[r("el-select",{attrs:{clearable:"","value-key":"missionID",placeholder:"请选择航线"},on:{change:e.changeSelectAction},model:{value:e.form.missionID,callback:function(t){e.$set(e.form,"missionID",t)},expression:"form.missionID"}},e._l(e.routeOptions,(function(e){return r("el-option",{key:e.missionID,attrs:{value:e,label:e.missionName}})})),1)],1),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.modeTrue,expression:"!modeTrue"}],attrs:{label:"执行时间",prop:"excuteTime"}},[r("div",{staticClass:"div-content"},[r("el-select",{staticStyle:{width:"150px"},attrs:{disabled:!0},model:{value:e.mode,callback:function(t){e.mode=t},expression:"mode"}},e._l(e.modeOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),r("el-input",{directives:[{name:"show",rawName:"v-show",value:e.refereeWkArrTrue,expression:"refereeWkArrTrue"}],staticStyle:{width:"200px"},attrs:{disabled:!0},model:{value:e.weekDay,callback:function(t){e.weekDay=t},expression:"weekDay"}}),r("el-time-select",{attrs:{"picker-options":{start:"00:00",step:"00:01",end:"23:59"},placeholder:"选择时间"},model:{value:e.form.hourTime,callback:function(t){e.$set(e.form,"hourTime",t)},expression:"form.hourTime"}})],1)]),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.modeTrue,expression:"modeTrue"}],attrs:{label:"执行时间",prop:"excuteTime"}},[r("div",{staticClass:"div-content"},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.form.excuteTime,callback:function(t){e.$set(e.form,"excuteTime",t)},expression:"form.excuteTime"}}),r("el-time-select",{attrs:{"picker-options":{start:"00:00",step:"00:01",end:"23:59"},placeholder:"选择时间"},model:{value:e.form.hourTime,callback:function(t){e.$set(e.form,"hourTime",t)},expression:"form.hourTime"}})],1)]),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.modeTrue,expression:"!modeTrue"}],attrs:{label:"执行区间",prop:"excuteTime"}},[r("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},model:{value:e.form.startTime,callback:function(t){e.$set(e.form,"startTime",t)},expression:"form.startTime"}})],1),r("el-form-item",{attrs:{label:"备注",prop:"content"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),r("el-button",{on:{click:e.cancelAction}},[e._v("取 消")])],1)],1)},i=[],s=r("ade3"),n=(r("a9e3"),r("5575")),a=r("e52e"),u={data:function(){var e;return{form:{excuteTime:"",hourTime:"",missionID:""},siteID:"",siteName:"",activeButton:"",modeTrue:!0,mode:1,divId:"",visible:!1,queryParams:{},routeOptions:[],weekDay:"",refereeWkArrTrue:!1,modeOptions:[{label:"单次",value:1},{label:"每天",value:2},{label:"每周",value:3},{label:"每月",value:4}],rules:(e={missionID:[{required:!0,message:"计划任务不能为空",trigger:"blur"}],excuteTime:[{required:!0,message:"执行时间不能为空",trigger:"blur"}]},Object(s["a"])(e,"excuteTime",[{required:!0,message:"执行日期不能为空",trigger:"blur"}]),Object(s["a"])(e,"startTime",[{required:!0,message:"生效范围不能为空",trigger:"blur"}]),Object(s["a"])(e,"refereeWkArr",[{required:!0,message:"选择日期不能为空",trigger:"blur"}]),Object(s["a"])(e,"refereeMkArr",[{required:!0,message:"选择日期不能为空",trigger:"blur"}]),e)}},methods:{cancelAction:function(){this.form={excuteTime:"",hourTime:"",missionID:""},this.devId="",this.siteID="",this.siteName="",this.activeButton="",this.modeTrue=!0,this.mode="",this.visible=!1,this.$emit("changeValue",!1),console.info("this.form",this.$parent),this.$parent.$parent.divSelectClass(this.divId)},show:function(e,t,r){this.siteID=e,this.siteName=t,this.modeTrue=!1,"daily"==r?this.mode=2:"weekly"==r?(this.mode=3,this.refereeWkArrTrue=!0):"monthly"==r?(this.refereeWkArrTrue=!0,this.mode=4):(this.modeTrue=!0,this.mode=1),console.log("siteID",e,r),this.visible=!0,this.queryParams={pageIndex:1,siteID:e,pageSize:1e4}},getDate:function(e){var t=e,r=t.split(" "),o=r[0].split("-"),i=r[1].split(":"),s=new Date(o[0],o[1]-1,o[2],i[0],i[1],i[2]);return s},getTimeToString:function(e,t){var r=e.getFullYear(),o=e.getMonth(),i=e.getDate(),s=t.getHours(),n=t.getMinutes(),a=t.getSeconds();return o>=1&&o<=9&&(o="0"+o),i>=0&&i<=9&&(i="0"+i),s>=0&&s<=9&&(s="0"+s),n>=0&&n<=9&&(n="0"+n),a>=0&&a<=9&&(a="0"+a),r+"-"+o+"-"+i+" "+s+":"+n+":"+a},queryListMin:function(){var e=this;Object(n["w"])(this.queryParams).then((function(t){e.routeOptions=t.data.list}))},submitForm:function(){var e=this;this.$refs["form"].validate((function(t){if(t){console.log("form",e.form);var r=e.mode,o=e.form.hourTime;if(e.form.mode=r,1==r){var i=e.form.excuteTime;console.info("excuteTime",i,o),e.form.excuteTime=e.getDate(i+" "+o+":00").getTime()/1e3,e.form.min=-1,e.form.hour=-1,e.form.day=[],e.form.weekDay=[],e.form.startDate=0,e.form.endDate=0}else 2==r?(e.form.excuteTime=-1,e.form.min=Number(o.split(":")[1]),e.form.hour=Number(o.split(":")[0]),e.form.day=[],e.form.weekDay=[],console.info("this.form.startTime",e.form),e.form.startDate=e.form.startTime[0].getTime()/1e3,e.form.endDate=e.form.startTime[1].getTime()/1e3):3==r?(e.form.excuteTime=-1,e.form.min=Number(o.split(":")[1]),e.form.hour=Number(o.split(":")[0]),e.form.day=[],"星期一"==e.weekDay?e.form.refereeWkArr=[1]:"星期"==e.weekDay?e.form.refereeWkArr=[2]:"星期三"==e.weekDay?e.form.refereeWkArr=[3]:"星期四"==e.weekDay?e.form.refereeWkArr=[4]:"星期五"==e.weekDay?e.form.refereeWkArr=[5]:"星期六"==e.weekDay?e.form.refereeWkArr=[6]:e.form.refereeWkArr=[0],e.form.weekDay=e.form.refereeWkArr,e.form.startDate=e.form.startTime[0].getTime()/1e3,e.form.endDate=e.form.startTime[1].getTime()/1e3):(e.form.excuteTime=-1,e.form.min=Number(o.split(":")[1]),e.form.hour=Number(o.split(":")[0]),e.form.day=[Number(e.weekDay)],e.form.weekDay=[],e.form.startDate=e.form.startTime[0].getTime()/1e3,e.form.endDate=e.form.startTime[1].getTime()/1e3);if(void 0!=e.form.CMID)console.info("this.form",e.form),update(e.form).then((function(t){e.$modal.msgSuccess("修改成功"),e.open=!1,e.getList()}));else{var s=e.form.missionID;e.form.projectID=s.projectID,e.form.siteID=e.siteID,e.form.siteName=e.siteName,e.form.missionID=s.missionID,e.form.missionName=s.missionName,Object(a["a"])(e.form).then((function(t){e.$modal.msgSuccess("新增成功"),e.$parent.$parent.divSelectClass(e.divId),e.$emit("changeValue",!0),e.visible=!1})).error((function(t){e.form.excuteTime=1e3*e.form.excuteTime}))}}}))},initParam:function(e,t,r,o){this.queryListMin(),this.form.hourTime=e,this.form.excuteTime=t,3==this.mode?this.weekDay=r:4==this.mode&&(this.weekDay=t.split("-")[2]),this.divId=o,console.log(e,"date",t)}}},c=u,l=(r("511f1"),r("2877")),m=Object(l["a"])(c,o,i,!1,null,"b8762306",null);t["default"]=m.exports},b1e1:function(e,t,r){},e52e:function(e,t,r){"use strict";r.d(t,"e",(function(){return s})),r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return a})),r.d(t,"a",(function(){return u})),r.d(t,"f",(function(){return c})),r.d(t,"b",(function(){return l}));var o=r("b775"),i=r("c38a");function s(e){return console.info(e),Object(o["a"])({url:"/fcs/timed_tasks/page",method:"get",params:e})}function n(e){return Object(o["a"])({url:"/fcs/timed_tasks/"+Object(i["g"])(e),method:"get"})}function a(e){return Object(o["a"])({url:"/dataCenter/fcs/sites/missions?siteIDs="+Object(i["g"])(e),method:"get"})}function u(e){return Object(o["a"])({url:"/fcs/timed_tasks",method:"post",data:e})}function c(e){return Object(o["a"])({url:"/fcs/timed_tasks/"+Object(i["g"])(e.timedTaskId),method:"PUT",data:e})}function l(e){return Object(o["a"])({url:"/fcs/timed_tasks/"+Object(i["g"])(e),method:"delete"})}}}]);